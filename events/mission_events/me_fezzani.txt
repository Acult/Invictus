namespace = me_fezzani

me_fezzani.1 = { # task 1 - The People of Fezzan - start
    type = country_event
    title = me_fezzani_1_title
    desc = me_fezzani_1_desc
    picture = city_construction
	trigger = {
		always = yes
	}
    option = {
        name = me_fezzani_1.a
        custom_tooltip = me_fezzani_1.a.tt
    } 
}

me_fezzani.2 = { # task 2 - Establish Peace in Fezzan
    type = country_event
    title = me_fezzani_2_title
    desc = me_fezzani_2_desc
    picture = interesting_histories_ship_port_africa
	left_portrait = current_ruler
	trigger = {
		always = yes
	}

	# immediate = {
	# 	reverse_add_opinion = {
	# 		target = c:MHY
	# 		modifier = me_fezzani_1_nasamones_100_pos_opmod 
	# 	}
	# 	reverse_add_opinion = {
	# 		target = c:GAR
	# 		modifier = me_fezzani_1_nasamones_100_pos_opmod
	# 	} 
	# 	reverse_add_opinion = {
	# 		target = c:MKA
	# 		modifier = me_fezzani_1_nasamones_100_pos_opmod
	# 	}
	# 	reverse_add_opinion = {
	# 		target = c:PSY
	# 		modifier = me_fezzani_1_nasamones_100_pos_opmod
	# 	}
	# 	reverse_add_opinion = {
	# 		target = c:NAS
	# 		modifier = me_fezzani_1_nasamones_100_pos_opmod
	# 	}
	# 	reverse_add_opinion = {
	# 		target = c:PHZ
	# 		modifier = me_fezzani_1_nasamones_100_pos_opmod
	# 	}
	# }

    option = {
        name = me_fezzani_2.a
        add_political_influence = -50
		current_ruler = {
			add_popularity = 20
			add_trait = orator
		}
    }
}

me_fezzani.3 = { # task 3 - Leader of the fezzani
    type = country_event
    title = me_fezzani_3_title
    desc = me_fezzani_3_desc
    picture = interesting_histories_greek_debate
	left_portrait = current_ruler
	trigger = {
		always = yes
	}
    option = {
        name = me_fezzani_3.a
        add_country_modifier = {
            name = subjugated_other_fezzani
            duration = 365
        }
    }
}

me_fezzani.4 = { # task 4 - send an envoy to the great powers - Cyrenaica
    type = country_event
    title = me_fezanni_4_title
    desc = me_fezzani_4_desc
    picture = interesting_histories_greek_debate
    trigger = { 
		has_land = yes
		c:CYR = { # 
			has_land = yes
		}
 	}

	immediate = {
		p:3360.owner = {
			save_scope_as = fezzan_cyrenaica_owner_scope
		}
	}
	

	option = {		# Offer Slaves to Cyrenaica
		name = me_fezzani_4.a
		custom_tooltip = me_fezzani_4.at
		capital_scope = {
			while = {
				count = 5
				limit = {
					num_of_slaves > 0
				}
				random_pops_in_province = {
					limit = {
						pop_type = slaves
					}
					move_pop = p:3360
				}
			}
		}
		hidden_effect = {
			scope:me_fezzani_scope = {
				set_variable = {
					name = fezzan_cyrenaica_owner_offer
					value = 1
				}
			}
		}
 	}
	
    option = {   	# Offer Small Sum
        name = me_fezzani.4.b
		add_treasury = -100
        custom_tooltip = me_fezzani.4.bt
        hidden_effect = {
			scope:me_fezzani_scope = { 
				set_variable = {
					name = fezzan_cyrenaica_owner_offer
					value = 2
				}
			}
		}
	}

	option = {   	# Offer Nothing
        name = me_fezzani.4.c
        custom_tooltip = me_fezzani.4.ct
        current_ruler = { add_popularity = popularity_small }
        scope:me_fezzani_scope = { 
			set_variable = {
				name = fezzan_cyrenaica_owner_offer
				value = 3
			}
		}
	}

	after = {
		scope:fezzan_cyrenaica_owner_scope = {
			trigger_event = { 
				id = me_fezzani.25
				days = { 5 10 }
			}
		}
	}
}

me_fezzani.5 = { # task 5 - befriend the garamantes
    type = country_event
    title = me_fezanni_5_title
    desc = me_fezzani_5_desc
    picture = interesting_histories_greek_debate

    trigger = { 
		has_land = yes
		c:GAR = { # Garamantes still exist
			has_land = yes
            is_subject = no # they are not a subject
		}
 	}

    option = { # potential vassal or claims
        name = me_fezzani_5.a
		scope:me_fezzani_scope = {
			set_variable = {
				name = nasamones_garamantes_owner_offer
		 		value = 1
	 		}
		}
 	}
	
    option = {   	# Offer vassalization
        name = me_fezzani.5.b
        hidden_effect = {
			scope:me_fezzani_scope = { 
				set_variable = {
					name = nasamones_garamantes_owner_offer
					value = 2
				}
			}
		}
	}
	after = {
		scope:fezzan_cyrenaica_owner_scope = {
			trigger_event = { 
				id = me_fezzani.6
				days = { 3 5 }
			}
		}
	}
}

me_fezzani.6 = { # task 6 - befriend the garamantes - garamantes ping
	type = country_event
	title = me_fezzani.6.t
	desc = {
    	desc = "me_fezzani.6.desc"
		first_valid = {
			triggered_desc = {		# Alliance Offered
				trigger = { scope:me_fezzani_scope.var:nasamones_garamantes_owner_offer = 1 }
				desc = "me_fezzani.6.desc_1"
			}
			triggered_desc = {		# Vassalization Offered
				trigger = { scope:me_fezzani_scope.var:nasamones_garamantes_owner_offer = 2 }
				desc = "me_fezzani.6.desc_2"
			}
		}
	}
	picture = greek_city
	left_portrait = current_ruler
	right_portrait = c:NAS.current_ruler
    goto_location = p:8128 # Nasamone's capital

	option = {	# Alliance
		name = me_fezzani.6.a
		custom_tooltip = me_fezzani.6.at
		scope:me_fezzani_scope = {
			set_variable = {
				name = nasamones_garamantes_owner_response
				value = 1
			}
		}
		reverse_add_opinion = {
			target = NAS
			modifier = me_fezzani_1_nasamones_50_pos_opmod 
        }
		reverse_add_opinion = {
			target = GAR
			modifier = me_fezzani_1_nasamones_50_pos_opmod 
        }
		ai_chance = {
			base = 1
			modifier = {
				factor = 2
				scope:me_fezzani_scope = { is_ai = no }
			}
			modifier = {
				factor = 10
				stability <= 30
			}
			modifier = {
				factor = 3
				calc_true_if = {
					current_ruler = {
						OR = {
							has_trait = weak_willed
							has_trait = corrupt
						}
					}
				}
			}
			modifier = {
				factor = 3
				scope:me_fezzani_scope.var:nasamones_garamantes_owner_offer = 1
			}
			modifier = {
				factor = 3
				scope:me_fezzani_scope.var:nasamones_garamantes_owner_offer = 2
			}
		}
	}

	option = {	# Vassalization
		name = me_fezzani.6.b
		custom_tooltip = me_fezzani.6.bt
		scope:me_fezzani_scope = {
			set_variable = {
				name = nasamones_garamantes_owner_response
				value = 2
			}
		}
		reverse_add_opinion = {
			target = NAS
			modifier = me_fezzani_1_nasamones_100_pos_opmod
        }
		reverse_add_opinion = {
			target = GAR
			modifier = me_fezzani_1_nasamones_100_pos_opmod
        }
		ai_chance = {
			base = 2
			modifier = {
				factor = 2
				scope:me_fezzani_scope = { is_ai = no }
			}
			modifier = {
				factor = -1000
				is_subject = yes
			}
			modifier = {
				factor = 3
				calc_true_if = {
					current_ruler = {
						OR = {
							has_trait = weak_willed
							has_trait = corrupt
						}
					}
				}
			}
			modifier = {
				factor = 3
				scope:me_fezzani_scope.var:nasamones_garamantes_owner_offer = 1
			}
			modifier = {
				factor = 4
				scope:me_fezzani_scope.var:nasamones_garamantes_owner_offer = 2
			}
		}
	}
	option = {	# Do Nothing
		name = me_fezzani.6.c
		custom_tooltip = me_fezzani.6.ct
		scope:me_fezzani_scope = {
			set_variable = {
				name = nasamones_garamantes_owner_response
				value = 3
			}
		}
		ai_chance = {
			base = 3
			modifier = {
				factor = 3
				scope:me_fezzani_scope = {
					opinion = {
						target = NAS
						value < 0
					}
				}
			}
			modifier = {
				factor = 5
				scope:me_fezzani_scope.var:nasamones_garamantes_owner_offer = 3
			}
		}
	}
	after = {
		scope:me_fezzani_scope = {
			trigger_event = { 
				id = me_fezzani.7 
				days = { 5 10 }
			}
		}
	}
}

me_fezzani.7 = { # Garamantes Response
    type = country_event
    title = me_fezanni_7_title
    picture = greek_city
	goto_location = p:8168
    left_portrait = current_ruler
    right_portrait = c:GAR.current_ruler
	desc = {
    	desc = "me_fezzani.28.desc"
		first_valid = {
			triggered_desc = {		# Gained A An Alliance
				trigger = { root.var:nasamones_garamantes_owner_response = 1 }
				desc = "me_fezzani.7.desc_1"
			}
			triggered_desc = {		# Gained An vassal
				trigger = { root.var:nasamones_garamantes_owner_response = 2 }
				desc = "me_fezzani.7.desc_2"
			}
			triggered_desc = {		# Spurned
				trigger = { root.var:nasamones_garamantes_owner_response = 3 }
				desc = "me_fezzani.7.desc_3"
			}
		}
	}

    trigger = { has_land = yes	}

	immediate = {
		if = {
			limit = {
				root.var:nasamones_garamantes_owner_response = 1
			}
			scope:me_fezzani_scope = {
				add_alliance = c:NAS
			    modifier = me_fezzani_1_nasamones_50_pos_opmod 
			}
		}
		else_if = {
			limit = {
				root.var:nasamones_garamantes_owner_response = 2
			}
			scope:me_fezzani_scope = {
				modifier = me_fezzani_1_nasamones_100_pos_opmod
				make_subject = {
					target = c:GAR
					type = feudatory # ?
				}
			}
		}
		else = {
			current_ruler = { add_popularity = -5  }
			add_political_influence = -5
		}
	}
	
	option = {   # Alliance
        name = me_fezzani.7.a
        trigger = { root.var:nasamones_garamantes_owner_response = 1 }
		custom_tooltip = me_fezzani.7.at
    }
	
    option = {	# Vassalization
        name = me_fezzani.7.b
        trigger = { root.var:nasamones_garamantes_owner_response = 2 }
		custom_tooltip = me_fezzani.7.bt
	}

	option = {	# Empty-Handed
        name = me_fezzani.7.c
        trigger = { root.var:nasamones_garamantes_owner_response = 3 }
		custom_tooltip = me_fezzani.7.ct
	}

	after = {
		remove_variable = nasamones_garamantes_owner_offer
		remove_variable = nasamones_garamantes_owner_response
	}
}

me_fezzani.8 = { # the kingdom of garamentes
    type = country_event
    title = me_fezanni_8_title
    desc = me_fezzani_8_desc
    picture = interesting_histories_greek_debate
    option = {
        name = me_fezzani_8.a
            add_country_modifier = {
                name = fezzani_garamantes_modifier
                duration = 3650
            }
    }
}

me_fezzani.9 = { # Strategic Planning
    type = country_event
    title = me_fezanni_9_title
    desc = me_fezzani_9_desc
    picture = interesting_histories_greek_debate
    option = {
        name = me_fezzani_9.a
		p:8162 = {
			set_city_status = city
			add_building_level = fortress_building
			add_2_free_province_investments = yes
		}
		any_owned_province = {
			AND = {
				is_in_area = hayaa_area
			}
			local_fort_limit = 3
		}
    }
}

me_fezzani.12 = {
    type = country_event
    title = me_fezanni_12_title
    desc = me_fezzani_12_desc
    picture = interesting_histories_greek_debate
	option = {
		name = me_fezzani_12.a
		if = {
			limit = {
				c:GAR = { # Garamantes still exist
					is_ai = yes
					has_land = yes
					is_subject_of = ROOT # they are a subject
                    is_subject_type = tributary
				}
			}
			release_subject = c:GAR
			make_subject = {
				target = c:GAR
				type = client_state
			}
		}
		if = {
			limit = {
				c:MHY = { # Garamantes still exist
					is_ai = yes
					has_land = yes
					is_subject_of = ROOT # they are a subject
                    is_subject_type = tributary
				}
			}
			release_subject = c:MHY
			make_subject = {
				target = c:MHY
				type = client_state
			}
		}
		if = {
			limit = {
				c:NAS = { # Garamantes still exist
					is_ai = yes
					has_land = yes
					is_subject_of = ROOT # they are a subject
                    is_subject_type = tributary
				}
			}
			release_subject = c:NAS
			make_subject = {
				target = c:NAS
				type = client_state
			}
		}
		if = {
			limit = {
				c:PSY = { # Garamantes still exist
					is_ai = yes
					has_land = yes
					is_subject_of = ROOT # they are a subject
                    is_subject_type = tributary
				}
			}
			release_subject = c:PSY
			make_subject = {
				target = c:PSY
				type = client_state
			}
		}
		if = {
			limit = {
				c:MKA = { # Garamantes still exist
					is_ai = yes
					has_land = yes
					is_subject_of = ROOT # they are a subject
                    is_subject_type = tributary
				}
			}
			release_subject = c:MKA
			make_subject = {
				target = c:MKA
				type = client_state
			}
		}
		if = {
			limit = {
				c:PHZ = { # Garamantes still exist
					is_ai = yes
					has_land = yes
					is_subject_of = ROOT # they are a subject
                    is_subject_type = tributary
				}
			}
			release_subject = c:PHZ
			make_subject = {
				target = c:PHZ
				type = client_state
			}
		}
	}
}

me_fezzani.11 = { # fezzani Domination
    type = country_event
    title = me_fezanni_11_title
    desc = me_fezzani_11_desc
    picture = interesting_histories_greek_debate
    option = { # give claims
        add_country_modifier = {
            name = fezzani_domination_modifier
            duration 3650
        }
    }
}

me_fezzani.24 = { # the perfect date
    type = country_event
    title = me_fezanni_24_title
    desc = me_fezzani_24_desc
    picture = interesting_histories_greek_debate
    option = { 
        name = me_fezzani_24.a
        add_country_modifier = {
            name = fezzani_the_perfect_date
            duration = 1095
        }
		random_owned_province = {
			limit = {
				is_capital = yes
				has_city_status = yes
			}
			add_building_level = commerce_building
			add_building_level = population_building
			create_state_pop = tribesmen
			create_state_pop = tribesmen
			create_state_pop = tribesmen
			create_state_pop = tribesmen
			create_state_pop = tribesmen
		}
    }
}

me_fezzani.25 = { # Cyrenaica Ping
	type = country_event
	title = me_fezanni_25_title
	desc = {
    	desc = "me_fezzani.25.desc"
		first_valid = {
			triggered_desc = {		# Large sum offered
				trigger = { scope:me_fezzani_scope.var:fezzan_cyrenaica_owner_offer = 1 }
				desc = "me_fezzani.25.desc_1"
			}
			triggered_desc = {		# Small sum offered
				trigger = { scope:me_fezzani_scope.var:fezzan_cyrenaica_owner_offer = 2 }
				desc = "me_fezzani.25.desc_2"
			}
			triggered_desc = {		# Nothing offered
				trigger = { scope:me_fezzani_scope.var:fezzan_cyrenaica_owner_offer = 3 }
				desc = "me_fezzani.25.desc_3"
			}
		}
	}
	picture = greek_city
	left_portrait = current_ruler
    right_portrait = c:CYR.current_ruler
    # goto_location = scope:me_fezzani_scope.capital_scope

	immediate = {	# Less money for balance reasons
		if = {
			limit = { scope:me_fezzani_scope.var:fezzan_cyrenaica_owner_offer = 1 }
			add_treasury = 100
			current_ruler = {
				add_gold = 100
				add_corruption = 20
			}
		}
		else_if = {
			limit = { scope:me_fezzani_scope.var:fezzan_cyrenaica_owner_offer = 2 }
			add_treasury = 25
			current_ruler = {
				add_gold = 25
				add_corruption = 5
			}
		}
		else = {
			current_ruler = { 
				add_popularity = popularity_small  
			}
		}
	}

	option = {	# Alliance plus something else?
		name = me_fezzani.25.a
		custom_tooltip = me_fezzani.25.at
		scope:me_fezzani_scope = {
			set_variable = {
				name = fezzan_cyrenaica_owner_response
				value = 1
			}
		}
		reverse_add_opinion = {
			target =  c:CYR # me_fezzani_scope
			modifier = me_fezzani_1_Cyrenaica_50_pos_opmod 
        }
		ai_chance = {
			base = 1
			modifier = {
				factor = 2
				scope:me_fezzani_scope = { is_ai = no }
			}
			modifier = {
				factor = 10
				stability <= 30
			}
			modifier = {
				factor = 3
				calc_true_if = {
					current_ruler = {
						OR = {
							has_trait = weak_willed
							has_trait = corrupt
						}
					}
				}
			}
			modifier = {
				factor = 5
				scope:me_fezzani_scope.var:fezzan_cyrenaica_owner_offer = 1
			}
		}
	}

	option = {	# Gain An Alliance
		name = me_fezzani.25.b
		custom_tooltip = me_fezzani.25.bt
		scope:me_fezzani_scope = {
			set_variable = {
				name = fezzan_cyrenaica_owner_response
				value = 2
			}
		}
		reverse_add_opinion = {
			target = c:CYR # me_fezzani_scope
			modifier = me_fezzani_1_Cyrenaica_100_pos_opmod
        }
		ai_chance = {
			base = 3
			modifier = {
				factor = 2
				scope:me_fezzani_scope = { is_ai = no }
			}
			modifier = {
				factor = -1000
				is_subject = yes
			}
			modifier = {
				add = -2
				calc_true_if = {
					current_ruler = {
						OR = {
							has_trait = proud
							has_trait = stubborn
						}
					}
				}
			}
			modifier = {
				factor = 3
				calc_true_if = {
					current_ruler = {
						OR = {
							has_trait = weak_willed
							has_trait = corrupt
						}
					}
				}
			}
			modifier = {
				factor = 2
				scope:me_fezzani_scope = {
					opinion = {
						target = c:CYR # me_fezzani_scope
						value >= 0
					}
				}
			}
			modifier = {
				factor = 5
				scope:me_fezzani_scope.var:fezzan_cyrenaica_owner_offer = 2
			}
		}
	}

	option = {	# Do Nothing
		name = me_fezzani.25.c
		custom_tooltip = me_fezzani.25.ct
		scope:me_fezzani_scope = {
			set_variable = {
				name = fezzan_cyrenaica_owner_response
				value = 3
			}
		}
		ai_chance = {
			base = 4
			modifier = {
				factor = 5
				scope:me_fezzani_scope = {
					opinion = {
						target = c:CYR # me_fezzani_scope
						value < 0
					}
				}
			}
			modifier = {
				factor = 5
				scope:me_fezzani_scope.var:fezzan_cyrenaica_owner_offer = 3
			}
		}
	}

	after = {
		scope:me_fezzani_scope = {
			trigger_event = { 
				id = me_fezzani.26
				days = { 5 10 }
			}
		}
	}
}

me_fezzani.26 = { # Cyrenaica response
    type = country_event
    title = me_fezanni_25_title
    picture = greek_city
	goto_location = p:3360
    left_portrait = current_ruler
    right_portrait = c:CYR.current_ruler
	desc = {
    	desc = "me_fezzani.26.desc"
		first_valid = {
			triggered_desc = {		# Gained A An Alliance with some improved opinion
				trigger = { root.var:fezzan_cyrenaica_owner_response = 1 }
				desc = "me_fezzani.26.desc_1"
			}
			triggered_desc = {		# Gained An Alliance
				trigger = { root.var:fezzan_cyrenaica_owner_response = 2 }
				desc = "me_fezzani.26.desc_2"
			}
			triggered_desc = {		# Spurned
				trigger = { root.var:fezzan_cyrenaica_owner_response = 3 }
				desc = "me_fezzani.26.desc_3"
			}
		}
	}

    trigger = { has_land = yes 	}

	immediate = {
		if = {
			limit = {
				root.var:fezzan_cyrenaica_owner_response = 1
			}
			scope:me_fezzani_scope = {
				add_alliance = c:CYR
			    modifier = me_fezzani_1_Cyrenaica_100_pos_opmod 
			}
		}
		else_if = {
			limit = {
				root.var:fezzan_cyrenaica_owner_response = 2
			}
			scope:me_fezzani_scope = {
				add_alliance = c:CYR
			}
		}
		else = {
			current_ruler = { add_popularity = -5  }
			add_political_influence = -5
		}
	}
	
	option = {   # Alliance with improved opinion
        name = me_fezzani.26.a
        trigger = { root.var:fezzan_cyrenaica_owner_response = 1 }
		custom_tooltip = me_fezzani.26.at
    }
	
    option = {	# Alliance
        name = me_fezzani.26.b
        trigger = { root.var:fezzan_cyrenaica_owner_response = 2 }
		custom_tooltip = me_fezzani.26.bt
	}

	option = {	# Empty-Handed
        name = me_fezzani.26.c
        trigger = { root.var:fezzan_cyrenaica_owner_response = 3 }
		custom_tooltip = me_fezzani.26.ct
		add_claim = { p:3360 }
	}

	after = {
		remove_variable = fezzan_cyrenaica_owner_offer
		remove_variable = fezzan_cyrenaica_owner_response
	}
}

me_fezzani.27 = {	#	Bonds With carthage - Start
    type = country_event
    title = me_fezanni_27_title
    desc = me_fezanni_27_desc
    picture = greek_city
	goto_location = p:3256
    left_portrait = current_ruler
    right_portrait = c:CAR.current_ruler

    trigger = { 
		has_land = yes
		c:CAR = { # 
			has_land = yes
		}
 	}

	immediate = {
		p:3256.owner = {
			save_scope_as = fezzan_carthage_owner_scope
		}
	}

	option = {		# Offer Manpower 
		name = me_fezzani.27.a
		add_manpower = -2
	 	custom_tooltip = me_fezzani.27.at
	 	hidden_effect = {
			scope:me_fezzani_scope = {
				set_variable = {
					name = fezzan_carthage_owner_offer
					  value = 1
				}
			 }
		 }
  	}
 
 	option = {   	# Offer Gold
		name = me_fezzani.27.b
		add_treasury = -200
	 	custom_tooltip = me_fezzani.27.bt
	 	hidden_effect = {
			scope:me_fezzani_scope = { 
				set_variable = {
				   name = fezzan_carthage_owner_offer
					value = 2
				}
			}
		 }
 	}

	 option = {   	# Offer Nothing
		name = me_fezzani.27.c
		current_ruler = { add_popularity = popularity_small }
	 	custom_tooltip = me_fezzani.27.ct
	 	hidden_effect = {
			scope:me_fezzani_scope = { 
				set_variable = {
					name = fezzan_carthage_owner_offer
					value = 3
				 }
			 }
		 }
 	}

 	after = {
		scope:fezzan_carthage_owner_scope = {
			trigger_event = { 
				id = me_fezzani.28
			 	days = { 5 10 }
		 	}
	 	}
 	}
}

me_fezzani.28 = { # carthage ping
	type = country_event
	title = me_fezzani.28.t
	desc = {
    	desc = "me_fezzani.28.desc"
		first_valid = {
			triggered_desc = {		# Manpower Offered
				trigger = { scope:me_fezzani_scope.var:fezzan_carthage_owner_offer = 1 }
				desc = "me_fezzani.28.desc_1"
			}
			triggered_desc = {		# Gold Offered
				trigger = { scope:me_fezzani_scope.var:fezzan_carthage_owner_offer = 2 }
				desc = "me_fezzani.28.desc_2"
			}
			triggered_desc = {		# Nothing Offered
				trigger = { scope:me_fezzani_scope.var:fezzan_carthage_owner_offer = 3 }
				desc = "me_fezzani.28.desc_3"
			}
		}
	}
	picture = greek_city
	left_portrait = current_ruler
    # goto_location = scope:me_fezzani_scope.capital_scope

	option = {	# alliance with improved relations
		name = me_fezzani.28.a
		custom_tooltip = me_fezzani.28.at
		scope:me_fezzani_scope = {
			set_variable = {
				name = fezzan_carthage_owner_response
				value = 1
			}
		}
		reverse_add_opinion = {
			target = me_fezzani_scope
			modifier = me_fezzani_1_carthage_50_pos_opmod 
        }
		ai_chance = {
			base = 1
			modifier = {
				factor = 2
				scope:me_fezzani_scope = { is_ai = no }
			}
			modifier = {
				factor = 10
				stability <= 30
			}
			modifier = {
				factor = 5
				has_senate_approval <= 30
			}
			modifier = {
				factor = 3
				calc_true_if = {
					current_ruler = {
						OR = {
							has_trait = weak_willed
							has_trait = corrupt
						}
					}
				}
			}
			modifier = {
				factor = 3
				scope:me_fezzani_scope.var:fezzan_carthage_owner_offer = 1
			}
			modifier = {
				factor = 3
				scope:me_fezzani_scope.var:fezzan_carthage_owner_offer = 2
			}
		}
	}

	option = {	# Gain An Alliance
		name = me_fezzani.28.b
		custom_tooltip = me_fezzani.28.bt
		scope:me_fezzani_scope = {
			set_variable = {
				name = fezzan_carthage_owner_response
				value = 2
			}
		}
		reverse_add_opinion = {
			target = me_fezzani_scope
			modifier = me_fezzani_1_carthage_100_pos_opmod
        }
		ai_chance = {
			base = 2
			modifier = {
				factor = 2
				scope:me_fezzani_scope = { is_ai = no }
			}
			modifier = {
				factor = -1000
				is_subject = yes
			}
			modifier = {
				factor = 3
				calc_true_if = {
					current_ruler = {
						OR = {
							has_trait = weak_willed
							has_trait = corrupt
						}
					}
				}
			}
			modifier = {
				factor = 3
				scope:me_fezzani_scope.var:fezzan_carthage_owner_offer = 1
			}
			modifier = {
				factor = 4
				scope:me_fezzani_scope.var:fezzan_carthage_owner_offer = 2
			}
		}
	}

	option = {	# Do Nothing
		name = me_fezzani.28.c
		custom_tooltip = me_fezzani.28.ct
		scope:me_fezzani_scope = {
			set_variable = {
				name = fezzan_carthage_owner_response
				value = 3
			}
		}
		ai_chance = {
			base = 3
			modifier = {
				factor = 3
				scope:me_fezzani_scope = {
					opinion = {
						target = me_fezzani_scope
						value < 0
					}
				}
			}
			modifier = {
				factor = 5
				scope:me_fezzani_scope.var:fezzan_carthage_owner_offer = 3
			}
		}
	}

	after = {
		scope:me_fezzani_scope = {
			trigger_event = { 
				id = me_fezzani.31 
				days = { 5 10 }
			}
		}
	}
}

me_fezzani.29 = {	#	Bonds With ptolemy - Start
    type = country_event
    title = me_fezzani.29.t
    desc = me_fezzani.29.desc
    picture = greek_city
	goto_location = p:516
    left_portrait = current_ruler
    right_portrait = c:EGY.current_ruler

    trigger = { 
		has_land = yes
		c:EGY = { # 
			has_land = yes
		}
 	}

	immediate = {
		p:516.owner = {
			save_scope_as = fezzan_ptolemy_owner_scope
		}
	}

    option = {		# Offer Large Sum
        name = me_fezzani.4.a
		add_treasury = -500
		custom_tooltip = me_fezzani.29.at
		hidden_effect = {
			scope:me_fezzani_scope = {
				set_variable = {
					name = fezzan_ptolemy_owner_offer
					value = 1
				}
			}
		}
    }

  	option = {   	# Offer Gold
		name = me_fezzani.29.b
		add_treasury = -400
	  	custom_tooltip = me_fezzani.29.bt
		hidden_effect = {
			scope:me_fezzani_scope = { 
				set_variable = {
					name = fezzan_ptolemy_owner_offer
					  value = 2
				  }
			  }
		}
  	}

  	option = {   	# Offer Nothing
		name = me_fezzani.29.c
	  	custom_tooltip = me_fezzani.29.ct
	  	current_ruler = { add_popularity = popularity_small }
	  	scope:me_fezzani_scope = { 
			set_variable = {
				name = fezzan_ptolemy_owner_offer
			  	value = 3
		  	}
	  	}
  	}

  	after = {
		scope:fezzan_ptolemy_owner_scope = {
			trigger_event = { 
				id = me_fezzani.30
			  	days = { 5 10 }
		  	}
		}
	}
}

me_fezzani.30 = { # ptolemy ping
    type = country_event
    title = me_fezanni_30_title
    picture = greek_city
	goto_location = p:516
    left_portrait = current_ruler
    right_portrait = c:EGY.current_ruler
	desc = {
    	desc = "me_fezzani.30.desc"
		first_valid = {
			triggered_desc = {		# Gained A An Alliance with some improved opinion
				trigger = { root.var:fezzan_ptolemy_owner_response = 1 }
				desc = "me_fezzani.30.desc_1"
			}
			triggered_desc = {		# Gained An Alliance
				trigger = { root.var:fezzan_ptolemy_owner_response = 2 }
				desc = "me_fezzani.30.desc_2"
			}
			triggered_desc = {		# Spurned
				trigger = { root.var:fezzan_ptolemy_owner_response = 3 }
				desc = "me_fezzani.30.desc_3"
			}
		}
	}

    trigger = { has_land = yes 	}

	immediate = {
		if = {
			limit = {
				root.var:fezzan_ptolemy_owner_response = 1
			}
			scope:me_fezzani_scope = {
				add_alliance = c:EGY
			    modifier = me_fezzani_1_ptolemy_100_pos_opmod 
			}
		}
		else_if = {
			limit = {
				root.var:fezzan_ptolemy_owner_response = 2
			}
			scope:me_fezzani_scope = {
				add_alliance = c:EGY
			}
		}
		else = {
			current_ruler = { add_popularity = -5  }
			add_political_influence = -5
		}
	}
	
	option = {   # Alliance with improved opinion
        name = me_fezzani.30.a
        trigger = { root.var:fezzan_ptolemy_owner_response = 1 }
		custom_tooltip = me_fezzani.30.at
    }
	
    option = {	# Alliance
        name = me_fezzani.30.b
        trigger = { root.var:fezzan_ptolemy_owner_response = 2 }
		custom_tooltip = me_fezzani.30.bt
	}

	option = {	# Empty-Handed
        name = me_fezzani.30.c
        trigger = { root.var:fezzan_ptolemy_owner_response = 3 }
		custom_tooltip = me_fezzani.30.ct
	}

	after = {
		scope:me_fezzani_scope = {
			trigger_event = { 
				id = me_fezzani.32
				days = { 5 10 }
			}
		}
	}
}

me_fezzani.31 = { # Carthage Response
    type = country_event
    title = me_fezanni_31_title
    picture = greek_city
	goto_location = p:3256
    left_portrait = current_ruler
    right_portrait = c:CAR.current_ruler
	desc = {
    	desc = "me_fezzani.31.desc"
		first_valid = {
			triggered_desc = {		# Gained A An Alliance with some improved opinion
				trigger = { root.var:fezzan_carthage_owner_response = 1 }
				desc = "me_fezzani.31.desc_1"
			}
			triggered_desc = {		# Gained An Alliance
				trigger = { root.var:fezzan_carthage_owner_response = 2 }
				desc = "me_fezzani.31.desc_2"
			}
			triggered_desc = {		# Spurned
				trigger = { root.var:fezzan_carthage_owner_response = 3 }
				desc = "me_fezzani.31.desc_3"
			}
		}
	}

    trigger = { has_land = yes 	}

	immediate = {
		if = {
			limit = {
				root.var:fezzan_carthage_owner_response = 1
			}
			scope:me_fezzani_scope = {
				add_alliance = c:CAR
			    modifier = me_fezzani_1_carthage_100_pos_opmod 
			}
		}
		else_if = {
			limit = {
				root.var:fezzan_carthage_owner_response = 2
			}
			scope:me_fezzani_scope = {
				add_alliance = c:CAR
			}
		}
		else = {
			current_ruler = { add_popularity = -5  }
			add_political_influence = -5
		}
	}
	
	option = {   # Alliance with improved opinion
        name = me_fezzani.31.a
        trigger = { root.var:fezzan_carthage_owner_response = 1 }
		custom_tooltip = me_fezzani.31.at
    }
	
    option = {	# Alliance
        name = me_fezzani.31.b
        trigger = { root.var:fezzan_carthage_owner_response = 2 }
		custom_tooltip = me_fezzani.31.bt
	}

	option = {	# Empty-Handed
        name = me_fezzani.31.c
        trigger = { root.var:fezzan_carthage_owner_response = 3 }
		custom_tooltip = me_fezzani.31.ct
	}

	after = {
		remove_variable = fezzan_carthage_owner_offer
		remove_variable = fezzan_carthage_owner_response
	}
}

me_fezzani.32 = { # ptolemy response
    type = country_event
    title = me_fezanni_32_title
    picture = greek_city
	goto_location = p:516
    left_portrait = current_ruler
    right_portrait = c:EGY.current_ruler
	desc = {
    	desc = "me_fezzani.32.desc"
		first_valid = {
			triggered_desc = {		# Gained A An Alliance with some improved opinion
				trigger = { root.var:fezzan_ptolemy_owner_response = 1 }
				desc = "me_fezzani.32.desc_1"
			}
			triggered_desc = {		# Gained An Alliance
				trigger = { root.var:fezzan_ptolemy_owner_response = 2 }
				desc = "me_fezzani.32.desc_2"
			}
			triggered_desc = {		# Spurned
				trigger = { root.var:fezzan_ptolemy_owner_response = 3 }
				desc = "me_fezzani.32.desc_3"
			}
		}
	}

    trigger = { has_land = yes 	}

	immediate = {
		if = {
			limit = {
				root.var:fezzan_ptolemy_owner_response = 1
			}
			scope:me_fezzani_scope = {
				add_alliance = c:EGY
			    modifier = me_fezzani_1_ptolemy_100_pos_opmod 
			}
		}
		else_if = {
			limit = {
				root.var:fezzan_ptolemy_owner_response = 2
			}
			scope:me_fezzani_scope = {
				add_alliance = c:EGY
			}
		}
		else = {
			current_ruler = { add_popularity = -5  }
			add_political_influence = -5
		}
	}
	
	option = {   # Alliance with improved opinion
        name = me_fezzani.32.a
        trigger = { root.var:fezzan_ptolemy_owner_response = 1 }
		custom_tooltip = me_fezzani.32.at
    }
	
    option = {	# Alliance
        name = me_fezzani.32.b
        trigger = { root.var:fezzan_ptolemy_owner_response = 2 }
		custom_tooltip = me_fezzani.32.bt
	}

	option = {	# Empty-Handed
        name = me_fezzani.32.c
        trigger = { root.var:fezzan_ptolemy_owner_response = 3 }
		custom_tooltip = me_fezzani.32.ct
	}

	after = {
		remove_variable = fezzan_ptolemy_owner_offer
		remove_variable = fezzan_ptolemy_owner_response
	}
}