namespace = cappadocia_event

cappadocia_event.1 = { # eumenes' kids start rebellion
	type = country_event
	title = cappadocia_event.1.t
	desc = cappadocia_event.1.desc
	picture = successors

	left_portrait = current_ruler
	right_portrait = char:431 # Eumenes
	right_portrait = char:432 # Artonis

	immediate = {
		custom_tooltip = eumenes_heirs_rise_up_tt
		hidden_effect = {
			if = {
				limit = {
					char:432 = { is_alive = yes }
				}
				char:432 = {
					remove_all_positions = yes
					save_scope_as = eumenid_rebllion_leader
				}
			}
			else_if = {
				limit = {
					char:433 = { is_alive = yes }
				}
				char:433 = {
					remove_all_positions = yes
					save_scope_as = eumenid_rebllion_leader
				}
			}
			else_if = {
				limit = {
					char:434 = { is_alive = yes }
				}
				char:434 = {
					remove_all_positions = yes
					save_scope_as = eumenid_rebllion_leader
				}
			}
			else_if = {
				limit = {
					char:435 = { is_alive = yes }
				}
				char:435 = {
					remove_all_positions = yes
					save_scope_as = eumenid_rebllion_leader
				}
			}
			start_civil_war = scope:eumenid_rebllion_leader
			scope:eumenid_rebllion_leader.employer = {
				set_country_heritage = cappadocian_heritage
				change_country_name = cappadocia_rebellion_name
				change_country_adjective = cappadocia_rebellion_adj
				save_scope_as = eumenid_rebellion_scope
				change_country_color = eumenid_blue
			}
			p:1954 = { # Garsaura
				set_owned_by = scope:eumenid_rebellion_scope
			}
			scope:eumenid_rebellion_scope = {
				every_owned_province = {
					limit = {
						NOT = { this = p:1954 }
					}
					remove_building_level = fortress_building
					set_owned_by = root
				}
			}
			p:1788 = { # Nora
				set_owned_by = scope:eumenid_rebellion_scope
			}
			if = {
				limit = {
					NOT = {
						scope:eumenid_rebllion_leader = char:433
						char:433 = { is_alive = yes }
					}
				}
				char:433 = {
					move_country = scope:eumenid_rebellion_scope
				}
			}
			if = {
				limit = {
					NOT = {
						scope:eumenid_rebllion_leader = char:434
						char:434 = { is_alive = yes }
					}
				}
				char:434 = {
					move_country = scope:eumenid_rebellion_scope
				}
			}
			if = {
				limit = {
					NOT = {
						scope:eumenid_rebllion_leader = char:435
						char:435 = { is_alive = yes }
					}
				}
				char:435 = {
					move_country = scope:eumenid_rebellion_scope
				}
			}
		}
	}

	option = {
		name = cappadocia_event.1.a
		custom_tooltip = help_from_overlord_tt
		c:PRY = {
			trigger_event = {
				id = cappadocia_event.5
				days = 7
			}
		}
	}
}

cappadocia_event.2 = { # send gifts to overlord
	type = country_event
	title = cappadocia_event.2.t
	desc = cappadocia_event.2.desc
	picture = successors

	left_portrait = current_ruler
	right_portrait = c:PRY.current_ruler

	option = {
		name = cappadocia_event.2.a
		add_treasury = -300
	}

	option = {
		name = cappadocia_event.2.b
		add_manpower = -10
		set_variable = sent_manpower_cap
	}

	after = {
		c:PRY = {
			trigger_event = {
				id = cappadocia_event.3
				days = { 7 14 }
			}
		}
	}
}

cappadocia_event.3 = { #ping antigonids from c:CAP for gifts
	type = country_event
	title = cappadocia_event.3.t
	desc = cappadocia_event.3.desc
	picture = successors

	left_portrait = current_ruler
	right_portrait = c:CAP.current_ruler

	immediate = {
		if = {
			limit = {
				c:CAP = {
					has_variable = sent_manpower_cap
				}
			}
			add_manpower = 10
		}
		else = {
			add_treasury = 300
		}
	}

	option = { # send tech
		name = cappadocia_event.3.b
		add_country_modifier = {
			name = cap_anti_temp_tech_mod
			duration = 1825 # 5 years
		}
		c:CAP = {
			set_variable = tech_received
		}
	}

	option = { # send pi; some will get "converted" (very favourably) into a free province investment
		name = cappadocia_event.3.b
		add_political_influence = -50
	}

	after = {
		c:CAP = {
			trigger_event = {
				id = cappadocia_event.4
				days = { 90 120 } # so simulate a longer decision time
			}
		}
	}
}

cappadocia_event.4 = { # ping gift from c:PRY
	type = country_event
	title = cappadocia_event.4.t
	desc = cappadocia_event.4.desc
	picture = successors

	left_portrait = current_ruler
	right_portrait = c:PRY.current_ruler

	option = {
		name = cappadocia_event.4.a
		if = {
			limit = {
				has_variable = tech_received
			}
			add_innovation = 1
			add_research = {
				technology = military_tech
				value = 5
			}
				add_research = {
				technology = civic_tech
				value = 5
			}
			add_research = {
				technology = oratory_tech
				value = 5
			}
			add_research = {
				technology = religious_tech
				value = 5
			}
		}
		else = {
			add_political_influence = 25
			add_1_free_province_investments = yes
		}
	}

	after = {
		if = {
			limit = { has_variable = tech_received }
			remove_variable = tech_received
		}
		if = {
			limit = { has_variable = sent_manpower_cap }
			remove_variable = sent_manpower_cap
		}
	}
}

cappadocia_event.5 = { # ping to antiginids about eumenes
	type = country_event
	title = cappadocia_event.5.t
	desc = cappadocia_event.5.desc
	picture = successors

	left_portrait = current_ruler
	right_portrait = c:CAP.current_ruler

	option = { # join war
		name = cappadocia_event.5.a
		every_current_war = {
			limit = {
				any_war_defender = {
					this = c:CAP
				}
				is_civil_war = yes
			}
			c:PRY = {
				add_to_war = {
					target = PREV
					attacker = no
					leader = no
				}
			}
		}
		c:CAP = {
			set_variable = overlord_joined_war_var
		}
	}

	option = { # send help
		name = cappadocia_event.5.b
		add_manpower = -5
		add_treasury = -100
		c:CAP = {
			set_variable = helped_in_war_var
		}
	}

	option = { # don't help and ignore
		name = cappadocia_event.5.c
		reverse_add_opinion = {
			modifier = manpower_gift_neg_opmod
			target = c:CAP
		}
	}

	after = {
		c:CAP = {
			trigger_event = {
				id = cappadocia_event.6
				days = 7
			}
		}
	}
}

cappadocia_event.6 = { # ping eumenes help or not by antigonids
	type = country_event
	title = cappadocia_event.6.t
	desc = {
		first_valid = {
			triggered_desc = {
				trigger = { has_variable = overlord_joined_war_var }
				desc = cappadocia_event.6.desc_1
			}
			triggered_desc = {
				trigger = { has_variable = helped_in_war_var }
				desc = cappadocia_event.6.desc_2
			}
			triggered_desc = {
				trigger = { always = yes }
				desc = cappadocia_event.6.desc_3
			}
		}
	}
	picture = successors

	option = {
		name = cappadocia_event.6.a
		if = {
			limit = {
				has_variable = helped_in_war_var
			}
			add_treasury = 100
			add_manpower = 5
		}
	}

	after = {
		if = {
			limit = { has_variable = helped_in_war_var }
			remove_variable = helped_in_war_var
		}
		if = {
			limit = { has_variable = overlord_joined_war_var }
			remove_variable = overlord_joined_war_var
		}
	}
}

cappadocia_event.7 = { # Ariarathes tries to seize the throne
	type = country_event
	title = cappadocia_event.7.t
	desc = cappadocia_event.7.desc
	picture = successors

	left_portrait = current_ruler
	right_portrait = char:50

	immediate = {
		custom_tooltip = ariarathes_rebellion_tt
		hidden_effect = {
			p:1854 = { # Melitene
				create_country = {
					name = {
						name = "ARI_REB_NAME"
						adjective = "ARI_REB_ADJECTIVE"
					}
					set_country_heritage = cappadocian_heritage
					save_scope_as = ariarathes_rebellion_scope
					if = {
						limit = {
							c:ARM = {
								has_land = yes
							}
						}
						c:ARM = {
							make_subject = {
								target = scope:ariarathes_rebellion_scope
								type = tributary
							}
						}
					}
					add_treasury = 250
					random_character = {
						limit = {
							is_ruler = yes
						}
						save_scope_as = misery_for_me
						remove_all_positions = yes
						move_country = c:MER
					}
					set_as_ruler = char:50
				}
				area = {
					every_area_province = {
						set_owned_by = scope:ariarathes_rebellion_scope
					}
				}	
			}
		}
		scope:ariarathes_rebellion_scope = {
			declare_war_with_wargoal = { # should call overlord in
				target = root
				war_goal = imperial_conquest_wargoal
			}
			random_current_war = {
				limit = {
					any_war_defender = {
						tag = CAP
					}
				}
				save_scope_as = ari_war_scope
			}
			if = {
				limit = {
					c:ARM = {
						has_land = yes
					}
				}
				c:ARM = {
					add_to_war = {
						target = scope:ari_war_scope
						attacker = yes
						leader = no
					}
				}
			}
		}
	}

	option = {
		name = cappadocia_event.7.a
		add_country_modifier = {
			name = satrapy_borders_restored
			duration = -1
		}
	}

	after = {
		scope:misery_for_me = {
			move_country = scope:ariarathes_rebellion_scope
		}
	}
}

## Buy Tyana from the Antigonids event