namespace = thebes_battle_counting

thebes_battle_counting.1 = {
    type = country_event
    hidden = yes
    trigger = {
        tag = THE
        NOT = { has_variable = stop_counting_idiot }
        scope:actor = { #This is the unit scope
            has_legion_trigger = yes
        }
    }
    immediate = {
        if = {
            limit = {
                NOR = {
                    has_variable = error_log_appeasing_var_3
                    has_variable = legion_battle_counter
                }
            }
            set_variable = error_log_appeasing_var_3
        }
        if = {
            limit = {
                NOT = { has_variable = legion_battle_counter }
            }
            set_variable = {
                name = legion_battle_counter
                value = 1
            }
        }
        else_if = {
            limit = { var:legion_battle_counter < 26 }
            change_variable = {
                name = legion_battle_counter
                add = 1
            }
        }        
    }     
}

namespace = me_thebes

me_thebes.1 = { # Task 1
    type = country_event
    title = me_thebes_1_title
    desc = me_thebes_1_desc
    picture = hellenic_marketplace
    left_portrait = current_ruler

    option = {
        name = me_thebes_1.a
        add_country_modifier = {
            name = building_spree
            duration = 1095
        }
    }
}
me_thebes.2 = { # Task 2
    type = country_event
    title = me_thebes_2_title
    desc = me_thebes_2_desc
    picture = hellenic_marketplace
    left_portrait = current_ruler

    option = {
        name = me_thebes_2.a
        custom_tooltip = me_thebes_2_tooltip
        add_country_modifier = {
            name = boetian_preparations
            duration = 730
        }
    }
}
me_thebes.3 = { # Task 3
    type = country_event
    title = me_thebes_3_title
    desc = me_thebes_3_desc
    picture = hellenic_marketplace
    left_portrait = current_ruler

    option = {
        name = me_thebes_3.a
        show_as_tooltip = {
            p:426 = {
                add_permanent_province_modifier = {
                    name = city_of_thebes
                    mode = add
                }
            }            
        }
    }
}
me_thebes.4 = { # Task 4 - Start
    type = country_event
    title = me_thebes_4_title
    desc = me_thebes_4_desc
    picture = hellenic_marketplace
    left_portrait = current_ruler
    right_portrait = scope:hired_mercenary

    immediate = {
        random_character = {
            limit = { is_mercenary = yes}
            save_scope_as = hired_mercenary
        }
    }

    option = {
        name = me_thebes_4.a #Have hired_mercenary prepare for battle with current ruler
    }
}
me_thebes.5 = { # Task 4 - End
    type = country_event
    title = me_thebes_5_title
    desc = me_thebes_5_desc
    picture = hellenic_marketplace
    left_portrait = current_ruler
    right_portrait = scope:hired_mercenary

    immediate = {
        random_unit = {
            limit = {
                commander = scope:hired_mercenary
            }
            save_scope_as = mercenary_army
        }
    }

    option = {
        name = me_thebes_5.a
        current_ruler = {
            add_martial = { 1 2 }
        }
        scope:hired_mercenary = {
            add_martial = { 1 2 }
        }
        if = {
            limit = {
                scope:mercenary_army = { exists = yes }
            }
            scope:mercenary_army = {
                add_unit_modifier = {
                    name = boetian_war_prep
                    duration = 730
                }
            }
        }
    }
}
me_thebes.6 = { # Task 5 -  Boetian war
    type = country_event
    title = me_thebes_6_title
    desc = me_thebes_6_desc
    picture = hellenic_marketplace
    left_portrait = current_ruler

    option = {
        name = me_thebes_6.a #Boetia will be crushed!!!
        show_as_tooltip = {
            add_country_modifier = {
                name = boetian_struggle
                duration = 730
            }            
        }
    }
}
me_thebes.7 = { # Task 6 - 
    type = country_event
    title = me_thebes_7_title
    desc = me_thebes_7_desc
    picture = hellenic_marketplace
    left_portrait = current_ruler

    option = {
        name = me_thebes_7.a #p:468 will prosper!
        show_as_tooltip = {
            p:468 = {
                add_province_modifier = {
                    name = theban_influence 
                    duration = 3650
                }
                capital_formable_small_effect = yes
            }          
        }
    }
}