cappadocia_mission_inv = {
	icon = general_1
	header = mission_image_athens

	repeatable = no

	chance = {
		factor = 10
	}

	ai_chance = { factor = 10 }

	potential = {
		tag = CAP
		NOT = {
			has_variable = cap_mis_abort_var
		}
	}

	abort = {
		ai_mission_back_out_trigger = yes
	}

	on_start = {
		start_mission_ai_effect = yes
	}

	on_completion = {
		complete_mission_effect = yes
	}

	on_abort = {
		set_variable = {
			name = cap_mis_abort_var
			days = 7300
		}
	}

	cappadocia_mission_inv_1_task = {  #Stabilize Our Position
		icon = task_political

		highlight = {
			scope:province = {
				owner = root
				OR = {
					this = {
						any_pops_in_province = {
							pop_hapiness < 0.35
						}
					}
				}
			}
		}

		allow = {
			trigger_if = {
				limit = {
					is_ai = no
				}
				invention = global_cohort_recruit_speed_inv
				custom_tooltip = {
					text = cappadocia_fort_svalue_tt
					cappadocia_fort_svalue >= 10
				}
				custom_tooltip = {
					text = pops_happy_in_province_tt
					any_owned_province = {
						count = all
						any_pops_in_province = {
							count = all
							pop_hapiness >= 0.35 # not disloyal
						}
					}	
				}
			}	
			trigger_else = { # for ai
				cappadocia_fort_svalue >= 5
			}	
		}

		on_completion = {
			add_political_influence = 100
			add_treasury = 300
			add_manpower = 10 #1 Manpower = 500 Manpower in the game
			add_stability = 5
		}
	}

	### Branch 1 - Loyal Vassal
	cappadocia_mission_inv_2A_task = { #Strength with the Antigonids

		icon = task_diplomatic

		requires = { cappadocia_mission_inv_1_task }
		prevented_by = { cappadocia_mission_inv_26_task cappadocia_mission_inv_2B_task }

		allow = { 
			hidden:overlord = { 
				opinion = { 
					target = root 
					value >= 120
				} 
			}
            hidden:current_ruler = { is_friend = root.overlord.current_ruler }
		}

		on_completion = {
			add_country_modifier = {
				name = loyal_cap_mod
				duration = -1
			}
		}

		bypass = {
			is_subject = no
		}
	}

	cappadocia_mission_inv_3A_task = { #The Eumenid Menace Rises Again 
		icon = task_expansion

		requires = { cappadocia_mission_inv_2A_task }

		bypass = { # Eumenes' Wife and Children are dead
			char:432 = { is_alive = no }
			char:433 = { is_alive = no }
			char:434 = { is_alive = no }
			char:435 = { is_alive = no }
		}

		on_completion = {
			custom_tooltip = eumenes_heirs_rise_up_tt
			trigger_event = {
				id = cappadocia_event.1
			}
			# char:431 is eumenes of cardia (dead)
			# char:433 is the oldest son
			# char:432 is wife of eumenes
			# char:434 is 2nd son, char:435 is daughter
			# p:1954 is Garsaura
			# p:1788 is Nora
			add_country_modifier = {
				name = dealing_with_eumenes
				duration = 3650 
			}
		}
	}

	cappadocia_mission_inv_4A_task = { #Rewards for Loyalty
		icon = task_expansion

		duration = 180

		requires = { cappadocia_mission_inv_2A_task }

		bypass = {
			is_subject = no
		}

		allow = {
			manpower >= 10
			treasury >= 500
			overlord = {
				has_civil_war = no
			}
		}

		on_start = {
			custom_tooltip = gift_to_overlord_cap_tt
			trigger_event = {
				id = cappadocia_event.2
			}
		}

		on_completion = {
			trigger_event = {
				id = cappadocia_event.8
			}
		}
	}

	cappadocia_mission_inv_5A_task = { #Pushing Back to Satrapy boundaries
		icon = task_expansion

		requires = { cappadocia_mission_inv_3A_task }

		bypass = {
			OR = {
				AND = {
					exists = overlord
					p:1790.owner = root.overlord
				}
				owns_area = p:1790.area
			}
		}

		on_completion = {
			custom_tooltip = one_v_one_pontus_tt # kinda; ai's allies can join
			declare_war_with_wargoal = {
                war_goal = conquer_wargoal
                province = 1790
                target = p:1790.owner
            }
			show_as_tooltip = {
				add_country_modifier = {
					name = satrapy_borders_restored
					duration = -1
				}
			}
		}
	}

	cappadocia_mission_inv_6A_task = { #The Persian Remnant
		icon = task_expansion

		requires = { cappadocia_mission_inv_3A_task }

		on_completion = {
			custom_tooltip = ariarathes_returns_tt
			trigger_event = {
				id = cappadocia_event.7
			}
		}
	}

	cappadocia_mission_inv_7A_task = { #Reclaiming Armenian Theft
		icon = task_expansion

		requires = { cappadocia_mission_inv_6A_task }

		bypass = {
			OR = {
				AND = {
					exists = overlord
					p:1767.owner = root.overlord
				}
				owns_area = p:1767.area
				is_subject = no
			}
		}

		on_completion = {
			custom_tooltip = one_v_one_armenia_tt # kinda; ai's allies can join
			declare_war_with_wargoal = {
                war_goal = conquer_wargoal
                province = 1767
                target = p:1767.owner
            }
		}
	}

	cappadocia_mission_inv_8A_task = { #The Richest Satrapy
		icon = task_expansion

		requires = { cappadocia_mission_inv_6A_task }

		highlight = {
			scope:province = {
				owner = root
				is_capital = yes
			}
		}

		allow = {
			has_monthly_income >= 25
			capital_scope.state = { incoming_trade_routes >= 12 }
			capital_scope = {
				civilization_value >= 50
				any_pops_in_province = {
					count >= 10
					pop_type = nobles
				}
			}
			any_owned_province = {
				count >= 8
				has_city_status = yes
				civilization_value >= 35
				any_pops_in_province = {
					count >= 5
					pop_type = nobles
				}
			}
		}

		on_completion = {
			add_country_modifier = {
				name = richest_satrapy
				duration = -1
			}
		}
	}

	cappadocia_mission_inv_9A_task = { #Content in One’s Station
		icon = task_expansion

		duration = 365

		requires = { cappadocia_mission_inv_8A_task }
		prevented_by = { cappadocia_mission_inv_10A_task cappadocia_mission_inv_11A_task }
		final = yes

		bypass = {
			is_subject = no
		}

		on_start = {
			trigger_event = {
				id = cappadocia_event.12
			}
		}

		allow = {
			political_influence >= 50
		}

		on_completion = {
			trigger_event = {
				id = cappadocia_event.11
			}
			custom_tooltip = remaining_subject_events_tt
		}
	}

	cappadocia_mission_inv_10A_task = { #Rival to the Antigonids
		icon = task_expansion

		duration = 365

		requires = { cappadocia_mission_inv_8A_task }
		prevented_by = { cappadocia_mission_inv_9A_task cappadocia_mission_inv_11A_task }

		bypass = {
			is_subject = no
		}

		on_start = {
			custom_tooltip = cap_ant_rival_tt
			trigger_event = { #governor
				id = cappadocia_event.24
			}
			trigger_event = { #try to assassinate overlord ruler
				id = cappadocia_event.31
				days = 3
			}
		}

		on_completion = {
			custom_tooltip = cap_ant_rival_war_tt
			trigger_event = {
				id = cappadocia_event.23
			}
		}
	}

	cappadocia_mission_inv_11A_task = { #An Independent Hellenistic Kingdom
		icon = task_expansion

		duration = 365

		requires = { cappadocia_mission_inv_8A_task }
		prevented_by = { cappadocia_mission_inv_9A_task cappadocia_mission_inv_10A_task }

		on_start = {
			custom_tooltip = cap_indep_deal_tt
			trigger_event = {
				id = cappadocia_event.37
			}
		}

		on_completion = {
			custom_tooltip = cap_indep_tt
			trigger_event = {
				id = cappadocia_event.36
			}
		}
	}

	cappadocia_mission_inv_12A_task = { #Antigonid Successor; Rename to "Amyntid Kingdom"
		icon = task_expansion

		requires = { cappadocia_mission_inv_10A_task }
		final = yes

		bypass = {
			is_subject = no
		}

		highlight = {
			scope:province = {
				OR = {
					province_id = 790 # Antigoneia
					province_id = 194 # Ankyra
					province_id = 379 # Pella
					province_id = 1951 #Tyana
					province_id = 292 # Sardeis
					province_id = 7998 # Gazioura
				}
			}
		}

		allow = {
			owns = 790 # Antigoneia
			owns = 194 # Ankyra
			owns = 379 # Pella
			owns = 1951 #Tyana
			owns = 292 # Sardeis
			owns = 7998 # Gazioura
		}

		on_completion = {
			change_country_name = amyntid_kingdom_name
			hidden_effect = {
				change_country_adjective = amyntid_adj
			}
			show_as_tooltip = {
				custom_tooltip = access_to_hellenistic_empire_tree_tt
				add_political_influence = 100
				add_manpower = 10
				add_country_modifier = {
					name = new_succesor_kingdom
					duration = -1
				}
			}
			trigger_event = {
				id = cappadocia_event.41
			}
		}
	}

	cappadocia_mission_inv_13A_task = { #Hegemon of Anatolia - Rename to "Anatolia" (that name maybe the cappadocian path?)
		icon = task_expansion

		requires = { cappadocia_mission_inv_11A_task }
		final = yes

		highlight = {
			scope:province = {
				OR = {
					is_in_region = cilicia_region
					is_in_region = cappadocia_pontica_region
					is_in_region = cappadocia_region
					is_in_region = galatia_region
					is_in_region = asia_region
				}
				NOT = {
					is_in_area = cyprus_area
				}
			}
		}

		allow = {
			region:cilicia_region = {
				any_region_province = {
					NOT = {
						is_in_area = cyprus_area
					}
					owner = root
					count = all
				}
			}
			region:cappadocia_pontica_region = {
				any_region_province = {
					owner = root
					count = all
				}
			}
			region:cappadocia_region = {
				any_region_province = {
					owner = root
					count = all
				}
			}
			region:galatia_region = {
				any_region_province = {
					owner = root
					count = all
				}
			}
			region:asia_region = {
				any_region_province = {
					owner = root
					count = all
				}
			}
			region:bithynia_region = {
				any_region_province = {
					owner = root
					count = all
				}
			}
		}

		on_completion = {
			trigger_event = {
				id = cappadocia_event.42
			}
			change_country_name = greater_cappadocia_name
			show_as_tooltip = {
				add_country_modifier = {
					name = hegemon_of_anatolia
					duration = -1
				}
				add_political_influence = 50
				add_military_experience = 100
				add_2_free_province_investments = yes
			}
		}
	}

	# Legacy of Persia
	cappadocia_mission_inv_2B_task = { # The Ariarathid Dynasty
		icon = task_expansion

		requires = { cappadocia_mission_inv_1_task }
		prevented_by = { cappadocia_mission_inv_2A_task cappadocia_mission_inv_26_task }

		allow = {}

		on_completion = {}
	}

	cappadocia_mission_inv_15_task = { # A Cappadocian Kingdom
		icon = task_expansion

		requires = { cappadocia_mission_inv_2B_task }
		#prevented_by = { cappadocia_mission_inv_16_task } # this would prevent the mission, the bypass doesn't. 
		# There sadly is no requires_or for the following task
		bypass = {
			has_variable = mission_task_15_bypass_var
		}

		allow = {}

		on_completion = {
			set_variable = mission_task_16_bypass_var
		}
	}

	cappadocia_mission_inv_16_task = { #An Armenian Partner
		icon = task_expansion

		requires = { cappadocia_mission_inv_2B_task }
		#prevented_by = { cappadocia_mission_inv_15_task } # this would prevent the mission, the bypass doesn't. 
		bypass = {
			has_variable = mission_task_16_bypass_var
		}

		allow = {}

		on_completion = {
			set_variable = mission_task_15_bypass_var
		}
	}

	cappadocia_mission_inv_17_task = { # The Seleukid Ultimatum
		icon = task_expansion

		requires = { cappadocia_mission_inv_15_task }

		allow = {}

		on_completion = {}
	}

	cappadocia_mission_inv_18_task = { # Persian Cappadocia
		icon = task_expansion

		requires = { cappadocia_mission_inv_16_task cappadocia_mission_inv_15_task}

		allow = {}

		on_completion = {}
	}

	cappadocia_mission_inv_19_task = { # A Greco-Persian World
		icon = task_expansion

		requires = { cappadocia_mission_inv_17_task }

		allow = {}

		on_completion = {}
	}

	cappadocia_mission_inv_19A_task = { # Zoroastrian Cappadocia
		icon = task_expansion

		requires = { cappadocia_mission_inv_18_task }

		allow = {}

		on_completion = {}
	}

	cappadocia_mission_inv_19B_task = { # An Armenian Presence
		icon = task_expansion

		requires = { cappadocia_mission_inv_16_task }

		allow = {}

		on_completion = {}
	}

	cappadocia_mission_inv_20_task = { # A True Persian Army
		icon = task_expansion

		requires = { cappadocia_mission_inv_17_task }

		allow = {}

		on_completion = {}
	}

	cappadocia_mission_inv_21_task = { # A Tolerant Realm
		icon = task_expansion

		requires = { cappadocia_mission_inv_19A_task }

		allow = {}

		on_completion = {}
	}

	cappadocia_mission_inv_22_task = { # Outliving the Armenians
		icon = task_expansion

		requires = { cappadocia_mission_inv_19B_task }

		allow = {}

		on_completion = {}
	}

	cappadocia_mission_inv_23_task = { # A Pontic Expedition
		icon = task_expansion

		requires = { cappadocia_mission_inv_19B_task }

		allow = {}

		on_completion = {}
	}

	cappadocia_mission_inv_24_task = { # The New Achaemenids
		icon = task_expansion

		requires = { cappadocia_mission_inv_23_task cappadocia_mission_inv_21_task cappadocia_mission_inv_20_task }
		final = yes

		allow = {}

		on_completion = {}
	}
	cappadocia_mission_inv_25_task = { # A Reliable Partner
		icon = task_expansion

		requires = { cappadocia_mission_inv_23_task }

		allow = {}

		on_completion = {}
	}

	### Eumenes' Path
	cappadocia_mission_inv_26_task = { # Heir to the Secretary of Alexander
		icon = task_expansion

		requires = { cappadocia_mission_inv_1_task }
		prevented_by = { cappadocia_mission_inv_2A_task cappadocia_mission_inv_2B_task }

		allow = {}

		on_completion = {}
	}

	cappadocia_mission_inv_27_task = { # The Ariarathid Threat
		icon = task_expansion

		requires = { cappadocia_mission_inv_26_task }

		allow = {}

		on_completion = {}
	}

	cappadocia_mission_inv_28_task = { # Accepting the Persians
		icon = task_expansion

		requires = { cappadocia_mission_inv_26_task }

		allow = {}

		on_completion = {}
	}

	cappadocia_mission_inv_29_task = { # Revenge for Eumenes of Cardia
		icon = task_expansion

		requires = { cappadocia_mission_inv_27_task }

		allow = {}

		on_completion = {}
	}

	cappadocia_mission_inv_30_task = { # Securing the Anatolian Landmass
		icon = task_expansion

		requires = { cappadocia_mission_inv_29_task }

		allow = {}

		on_completion = {}
	}

	cappadocia_mission_inv_31_task = { # Stamping Out the Antigonid Realm
		icon = task_expansion

		requires = { cappadocia_mission_inv_29_task }

		allow = {}

		on_completion = {}
	}

	cappadocia_mission_inv_32_task = { # Competitors in Asia
		icon = task_expansion

		requires = { cappadocia_mission_inv_30_task }

		allow = {}

		on_completion = {}
	}

	cappadocia_mission_inv_33_task = { # The Spoils of Cilicia Pedias
		icon = task_expansion

		requires = { cappadocia_mission_inv_31_task }

		allow = {}

		on_completion = {}
	}

	cappadocia_mission_inv_34_task = { # Alexander’s Empire
		icon = task_expansion

		requires = { cappadocia_mission_inv_32_task }
		final = yes

		allow = {}

		on_completion = {}
	}

	cappadocia_mission_inv_35_task = { # Alexander’s Vision
		icon = task_expansion

		requires = { cappadocia_mission_inv_32_task }

		allow = {}

		on_completion = {}
	}

    ### Branch 4 - Developing Cappadocia
	cappadocia_mission_inv_1d_task = { #The Trading Hub of Mazaka
		icon = task_economical

		highlight = {
			scope:province = {
				province_id = 1799
			}
		}

		allow = {
			p:1799 = { #Mazaka
				owner = root
				is_capital = yes
				num_of_commerce_building >= 6
				num_of_forum_building >= 3
				num_of_nobles >= 10
				province_income > 0.2
			}
		}

		on_completion = { 
			add_4_free_province_investments = yes
		}
	}
	cappadocia_mission_inv_2d_task = {  #Cappadocian Cavalry

		icon = task_economical

		requires = { cappadocia_mission_inv_1d_task }

		allow = {}

		on_completion = {}
	}   
	cappadocia_mission_inv_3d_task = { #The Palace of Gazioura p:7998
		icon = task_expansion

		requires = { cappadocia_mission_inv_1d_task }

		allow = {}

		on_completion = {}
	}
	cappadocia_mission_inv_4d_task = { #Hellenization of Cappadocia

		icon = task_expansion

		requires = { cappadocia_mission_inv_2d_task }

		allow = {}

		on_completion = {}
	}
	cappadocia_mission_inv_5d_task = { #Expand the Underground Cities
		icon = task_expansion

		requires = { cappadocia_mission_inv_2d_task cappadocia_mission_inv_3d_task }

		allow = {}

		on_completion = {}
	}
	cappadocia_mission_inv_6d_task = { #Administration in Tyana
		icon = task_expansion

		requires = { cappadocia_mission_inv_3d_task }

		allow = {}

		on_completion = {}
	}
	cappadocia_mission_inv_7d_task = { #Cappadocian Training

		icon = task_expansion

		requires = { cappadocia_mission_inv_4d_task }

		allow = {}

		on_completion = {}
	}
	cappadocia_mission_inv_8d_task = { # A Cappadocian Coast
		icon = task_expansion

		requires = { cappadocia_mission_inv_6d_task }

		allow = {}

		on_completion = {}
	}
	cappadocia_mission_inv_9d_task = { # Cilician Enterprise
		icon = task_expansion

		requires = { cappadocia_mission_inv_6d_task }

		allow = {}

		on_completion = {}
	}
}