cappadocia_mission_inv = {
	icon = general_1
	header = mission_image_athens

	repeatable = no

	chance = {
		factor = 10
	}

	ai_chance = { factor = 10 }

	potential = {
		tag = CAP
		NOT = {
			has_variable = cap_mis_abort_var
		}
	}

	abort = {
		ai_mission_back_out_trigger = yes
	}

	on_start = {
		start_mission_ai_effect = yes
	}

	on_completion = {
		complete_mission_effect = yes
	}

	on_abort = {
		custom_tooltip = judea_mission_abortion.tt # it's generic loc
		set_variable = {
			name = cap_mis_abort_var
			days = 7300
		}
	}

	cappadocia_mission_inv_1_task = {  #Stabilize Our Position
		icon = task_political

		highlight = {
			scope:province = {
				owner = root
				OR = {
					this = {
						any_pops_in_province = {
							pop_hapiness < 0.35
						}
					}
				}
			}
		}

		allow = {
			trigger_if = {
				limit = {
					is_ai = no
				}
				invention = global_cohort_recruit_speed_inv
				custom_tooltip = {
					text = cappadocia_fort_svalue_tt
					cappadocia_fort_svalue >= 10
				}
				custom_tooltip = {
					text = pops_happy_in_province_tt
					any_owned_province = {
						count = all
						any_pops_in_province = {
							count = all
							pop_hapiness >= 0.35 # not disloyal
						}
					}	
				}
			}	
			trigger_else = { # for ai
				cappadocia_fort_svalue >= 5
			}	
		}

		on_completion = {
			add_political_influence = 100
			add_treasury = 300
			add_manpower = 10 #1 Manpower = 500 Manpower in the game
			add_stability = 5
		}
	}

	### Branch 1 - Loyal Vassal
	cappadocia_mission_inv_2A_task = { #Strength with the Antigonids

		icon = task_diplomatic

		requires = { cappadocia_mission_inv_1_task }
		prevented_by = { cappadocia_mission_inv_26_task cappadocia_mission_inv_2B_task }

		allow = { 
			hidden:overlord = { 
				opinion = { 
					target = root 
					value >= 120
				} 
			}
            hidden:current_ruler = { is_friend = root.overlord.current_ruler }
		}

		on_completion = {
			add_country_modifier = {
				name = loyal_cap_mod
				duration = -1
			}
		}

		bypass = {
			is_subject = no
		}
	}

	cappadocia_mission_inv_3A_task = { #The Eumenid Menace Rises Again 
		icon = task_expansion

		requires = { cappadocia_mission_inv_2A_task }

		bypass = { # Eumenes' Wife and Children are dead
			char:432 = { is_alive = no }
			char:433 = { is_alive = no }
			char:434 = { is_alive = no }
			char:435 = { is_alive = no }
		}

		on_completion = {
			custom_tooltip = eumenes_heirs_rise_up_tt
			trigger_event = {
				id = cappadocia_event.1
			}
			# char:431 is eumenes of cardia (dead)
			# char:433 is the oldest son
			# char:432 is wife of eumenes
			# char:434 is 2nd son, char:435 is daughter
			# p:1954 is Garsaura
			# p:1788 is Nora
		}
	}

	cappadocia_mission_inv_4A_task = { #Rewards for Loyalty
		icon = task_expansion

		duration = 180

		requires = { cappadocia_mission_inv_2A_task }

		bypass = {
			is_subject = no
		}

		allow = {
			manpower >= 10
			treasury >= 500
			hidden:overlord = {
				has_civil_war = no
			}
		}

		on_start = {
			custom_tooltip = gift_to_overlord_cap_tt
			trigger_event = {
				id = cappadocia_event.2
			}
		}

		on_completion = {
			trigger_event = {
				id = cappadocia_event.8
			}
		}
	}

	cappadocia_mission_inv_5A_task = { #Pushing Back to Satrapy boundaries
		icon = task_expansion

		requires = { cappadocia_mission_inv_3A_task }

		bypass = {
			OR = {
				AND = {
					exists = overlord
					p:1790.owner = root.overlord
				}
				owns_area = p:1790.area
			}
		}

		on_completion = {
			custom_tooltip = one_v_one_pontus_tt # kinda; ai's allies can join
			declare_war_with_wargoal = {
                war_goal = conquer_wargoal
                province = 1790
                target = p:1790.owner
            }
			show_as_tooltip = {
				add_country_modifier = {
					name = satrapy_borders_restored
					duration = -1
				}
			}
		}
	}

	cappadocia_mission_inv_6A_task = { #The Persian Remnant
		icon = task_expansion

		requires = { cappadocia_mission_inv_3A_task }

		on_completion = {
			custom_tooltip = ariarathes_returns_tt
			trigger_event = {
				id = cappadocia_event.7
			}
		}
	}

	cappadocia_mission_inv_7A_task = { #Reclaiming Armenian Theft
		icon = task_expansion

		requires = { cappadocia_mission_inv_6A_task }

		bypass = {
			OR = {
				AND = {
					exists = overlord
					p:1767.owner = root.overlord
				}
				owns_area = p:1767.area
				is_subject = no
			}
		}

		on_completion = {
			custom_tooltip = one_v_one_armenia_tt # kinda; ai's allies can join
			declare_war_with_wargoal = {
                war_goal = conquer_wargoal
                province = 1767
                target = p:1767.owner
            }
		}
	}

	cappadocia_mission_inv_8A_task = { #The Richest Satrapy
		icon = task_expansion

		requires = { cappadocia_mission_inv_6A_task }

		highlight = {
			scope:province = {
				owner = root
				is_capital = yes
			}
		}

		allow = {
			has_monthly_income >= 25
			capital_scope.state = { incoming_trade_routes >= 12 }
			capital_scope = {
				civilization_value >= 50
				any_pops_in_province = {
					count >= 10
					pop_type = nobles
				}
			}
			any_owned_province = {
				count >= 8
				has_city_status = yes
				civilization_value >= 35
				any_pops_in_province = {
					count >= 5
					pop_type = nobles
				}
			}
		}

		on_completion = {
			add_country_modifier = {
				name = richest_satrapy
				duration = -1
			}
		}
	}

	cappadocia_mission_inv_9A_task = { #Content in One’s Station
		icon = task_expansion

		duration = 365

		requires = { cappadocia_mission_inv_8A_task }
		prevented_by = { cappadocia_mission_inv_10A_task cappadocia_mission_inv_11A_task }
		final = yes

		bypass = {
			is_subject = no
		}

		on_start = {
			trigger_event = {
				id = cappadocia_event.12
			}
		}

		allow = {
			political_influence >= 50
		}

		on_completion = {
			trigger_event = {
				id = cappadocia_event.11
			}
			custom_tooltip = remaining_subject_events_tt
		}
	}

	cappadocia_mission_inv_10A_task = { #Rival to the Antigonids
		icon = task_expansion

		duration = 365

		requires = { cappadocia_mission_inv_8A_task }
		prevented_by = { cappadocia_mission_inv_9A_task cappadocia_mission_inv_11A_task }

		bypass = {
			is_subject = no
		}

		on_start = {
			custom_tooltip = cap_ant_rival_tt
			trigger_event = { #governor
				id = cappadocia_event.24
			}
			trigger_event = { #try to assassinate overlord ruler
				id = cappadocia_event.31
				days = 3
			}
		}

		on_completion = {
			custom_tooltip = cap_ant_rival_war_tt
			trigger_event = {
				id = cappadocia_event.23
			}
		}
	}

	cappadocia_mission_inv_11A_task = { #An Independent Hellenistic Kingdom
		icon = task_expansion

		duration = 365

		requires = { cappadocia_mission_inv_8A_task }
		prevented_by = { cappadocia_mission_inv_9A_task cappadocia_mission_inv_10A_task }

		on_start = {
			custom_tooltip = cap_indep_deal_tt
			trigger_event = {
				id = cappadocia_event.37
			}
		}

		on_completion = {
			custom_tooltip = cap_indep_tt
			trigger_event = {
				id = cappadocia_event.36
			}
		}
	}

	cappadocia_mission_inv_12A_task = { #Antigonid Successor; Rename to "Amyntid Kingdom"
		icon = task_expansion

		requires = { cappadocia_mission_inv_10A_task }
		final = yes

		bypass = {
			is_subject = no
		}

		highlight = {
			scope:province = {
				OR = {
					province_id = 790 # Antigoneia
					province_id = 194 # Ankyra
					province_id = 379 # Pella
					province_id = 1951 #Tyana
					province_id = 292 # Sardeis
					province_id = 7998 # Gazioura
				}
			}
		}

		allow = {
			owns = 790 # Antigoneia
			owns = 194 # Ankyra
			owns = 379 # Pella
			owns = 1951 #Tyana
			owns = 292 # Sardeis
			owns = 7998 # Gazioura
		}

		on_completion = {
			change_country_name = amyntid_kingdom_name
			hidden_effect = {
				change_country_adjective = amyntid_adj
				change_country_color = amyntid_color
			}
			show_as_tooltip = {
				custom_tooltip = access_to_hellenistic_empire_tree_tt
				add_political_influence = 100
				add_manpower = 10
				add_country_modifier = {
					name = new_succesor_kingdom
					duration = -1
				}
			}
			trigger_event = {
				id = cappadocia_event.41
			}
		}
	}

	cappadocia_mission_inv_13A_task = { #Hegemon of Anatolia - Rename to "Anatolia" (that name maybe the cappadocian path?)
		icon = task_expansion

		requires = { cappadocia_mission_inv_11A_task }
		final = yes

		highlight = {
			scope:province = {
				OR = {
					is_in_region = cilicia_region
					is_in_region = cappadocia_pontica_region
					is_in_region = cappadocia_region
					is_in_region = galatia_region
					is_in_region = asia_region
				}
				NOT = {
					is_in_area = cyprus_area
				}
			}
		}

		allow = {
			region:cilicia_region = {
				any_region_province = {
					NOT = {
						is_in_area = cyprus_area
					}
					owner = root
					count = all
				}
			}
			region:cappadocia_pontica_region = {
				any_region_province = {
					owner = root
					count = all
				}
			}
			region:cappadocia_region = {
				any_region_province = {
					owner = root
					count = all
				}
			}
			region:galatia_region = {
				any_region_province = {
					owner = root
					count = all
				}
			}
			region:asia_region = {
				any_region_province = {
					owner = root
					count = all
				}
			}
			region:bithynia_region = {
				any_region_province = {
					owner = root
					count = all
				}
			}
		}

		on_completion = {
			trigger_event = {
				id = cappadocia_event.42
			}
			change_country_name = greater_cappadocia_name
			show_as_tooltip = {
				add_country_modifier = {
					name = hegemon_of_anatolia
					duration = -1
				}
				add_political_influence = 50
				add_military_experience = 100
				add_2_free_province_investments = yes
			}
		}
	}

	# Legacy of Persia
	cappadocia_mission_inv_2B_task = { # The Ariarathid Dynasty
		icon = task_expansion

		requires = { cappadocia_mission_inv_1_task }
		prevented_by = { cappadocia_mission_inv_2A_task cappadocia_mission_inv_26_task }

		on_completion = {
			custom_tooltip = switch_to_ari_tt
			trigger_event = {
				id = cappadocia_event.43
			}
		}
	}

	cappadocia_mission_inv_15_task = { # A Cappadocian Kingdom
		icon = task_expansion
		duration = 60

		requires = { cappadocia_mission_inv_2B_task }
		#prevented_by = { cappadocia_mission_inv_16_task } # this would prevent the mission, the bypass doesn't. 
		# There sadly is no requires_or for the following task
		bypass = {
			has_variable = mission_task_15_bypass_var
		}

		allow = {
			war = no
		}

		on_start = {
			set_variable = mission_task_16_bypass_var
			custom_tooltip = cap_paying_armenia_tt
			trigger_event = {
				id = cappadocia_event.44
			}
		}

		on_completion = {
			custom_tooltip = eumenes_heirs_rise_up_tt
			trigger_event = {
				id = cappadocia_event.1
			}
		}
	}

	cappadocia_mission_inv_16_task = { #An Armenian Partner
		icon = task_expansion
		duration = 60

		requires = { cappadocia_mission_inv_2B_task }
		#prevented_by = { cappadocia_mission_inv_15_task } # this would prevent the mission, the bypass doesn't. 
		bypass = {
			has_variable = mission_task_16_bypass_var
		}

		allow = {
			war = no
		}

		on_start = {
			set_variable = mission_task_15_bypass_var
			custom_tooltip = cap_armenia_rapprochement_tt
			trigger_event = {
				id = cappadocia_event.52
			}
		}

		on_completion = {
			custom_tooltip = eumenes_heirs_rise_up_tt
			trigger_event = {
				id = cappadocia_event.1
			}
		}
	}

	cappadocia_mission_inv_17_task = { # The Seleukid Ultimatum
		icon = task_expansion

		requires = { cappadocia_mission_inv_15_task }

		bypass = {
			c:SEL = {
				has_land = no
			}
		}

		highlight = {
			scope:province = {
				this = root.capital_scope
			}
		}

		allow = {
			OR = {
				is_subject_of = c:SEL
				is_subject = no
			}
			has_military_bonus = armenian_path_5
			capital_scope = {
				num_of_fortress_building >= 3
			}
		}

		on_completion = {
			custom_tooltip = seleukid_ultimatum_tt
			if = {
				limit = {
					root = {
						is_subject_of = c:SEL
					}
				}
				trigger_event = {
					id = cappadocia_event.57
				}
			}
			else = {
				trigger_event = {
					id = cappadocia_event.58
				}
			}
		}
	}

	cappadocia_mission_inv_18_task = { # Persian Cappadocia
		icon = task_expansion

		requires = { cappadocia_mission_inv_16_task cappadocia_mission_inv_15_task }

		highlight = {
			scope:province = {
				this = root.capital_scope
			}
		}

		allow = {
			calc_true_if = {
				amount >= 2
				military_tech >= 5
				civic_tech >= 5
				oratory_tech >= 5
				religious_tech >= 5
			}
			capital_scope = {
				num_of_nobles >= 15
			}
		}

		on_completion = {
			add_country_modifier = {
				name = persianized_cap
				duration = -1
			}
			add_research = {
				technology = civic_tech
				value = 15
			}
		}
	}

	cappadocia_mission_inv_19_task = { # A Greco-Persian World
		icon = task_expansion

		requires = { cappadocia_mission_inv_17_task }

		allow = {
			is_subject_of = c:SEL
			any_integrated_culture = {
				custom_tooltip = {
					text = cap_pers_cult_tt
					this.culture.culture_group = culture_group:persia
					country_culture_pop_count >= 50
				}
			}
			any_integrated_culture = {
				custom_tooltip = {
					text = cap_hell_cult_tt
					this.culture.culture_group = culture_group:hellenic
					country_culture_pop_count >= 50
				}
			}
		}

		on_completion = {
			add_country_modifier = {
				name = greco_persian_world
				duration = -1
			}
			add_research = {
				technology = military_tech
				value = 15
			}
			random_owned_province = {
				limit = {
					OR = {
						terrain = plains
						terrain = farmland
					}
				}
				set_trade_goods = elephants
			}
			custom_tooltip = unlock_zeus_dacieus_tt
			set_variable = unlock_zeus_dacieus_var
		}
	}

	cappadocia_mission_inv_19A_task = { # Zoroastrian Cappadocia
		icon = task_expansion

		requires = { cappadocia_mission_inv_18_task }

		highlight = {
			scope:province = {
				this = capital_scope
			}
		}

		allow = {
			political_influence >= pop_happiness_political_influence_svalue
			any_owned_province = {
				any_pops_in_province = {
					pop_hapiness >= 0.5
					NOT = { pop_religion = root.religion }
				}
			}
			capital_scope = {
				dominant_province_religion = root.religion
				hidden:state = { has_state_modifier = state_improvement_religious }
			}
		}

		on_completion = {
			add_political_influence = {
				value = pop_happiness_political_influence_svalue
				multiply = -1
			}
			add_country_modifier = {
				name = zoro_cap
				duration = 18250 # 50 years
			}
			custom_tooltip = pop_happy_convert_tt
			hidden_effect = {
				every_owned_province = {
					every_pops_in_province = {
						limit = {
							pop_hapiness >= 0.5
							NOT = {
								pop_religion = root.religion
							}
						}
						set_pop_religion = root.religion
					}
				}
			}
		}
	}

	cappadocia_mission_inv_19B_task = { # An Armenian Presence
		icon = task_expansion

		requires = { cappadocia_mission_inv_16_task }

		allow = {
			any_integrated_culture = {
				is_culture = armenian
				has_pop_type_right = nobles
				has_country_culture_modifier = honor_guard
			}
			any_integrated_culture = {
				is_culture = root.culture
				has_country_culture_modifier = citizenship_by_adoption
			}
		}

		on_completion = {
			add_innovation = 4
			custom_tooltip = armenian_pops_increase_tt
			hidden_effect = {
				while = {
					count = 2
					every_owned_province = {
						limit = {
							has_city_status = yes
						}
						define_pop = {
							type = nobles
							culture = armenian
							religion = zoroaster
						}
					}
					every_owned_province = {
						limit = {
							has_city_status = no
						}
						define_pop = {
							type = citizen
							culture = armenian
							religion = zoroaster
						}
					}
				}
			}
			create_character = {
				culture = armenian
				religion = zoroaster
				female = no
				hidden_effect = {
					add_martial = 4
					add_finesse = 4
					add_trait = intelligent
				}
			}
		}
	}

	cappadocia_mission_inv_20_task = { # A True Persian Army
		icon = task_expansion

		requires = { cappadocia_mission_inv_17_task }

		highlight = {
			scope:province = {
				this = capital_scope
			}
		}

		allow = {
			has_military_bonus = persian_bactrian_path_7
			OR = {
				has_law = work_for_the_best
				has_law = standing_army_law
			}
			# any_army = {
			# 	has_legion_trigger = yes
			# 	legion = ROOT.capital_scope.governorship.legion
			# }
			capital_scope = {
				num_of_military_building >= 3
			}
		}

		on_completion = {
			add_military_experience = 80
			add_country_modifier = {
				name = persian_army_cmod
				duration = -1
			}
		}
	}

	cappadocia_mission_inv_20B_task = { # A True Persian Army
		icon = task_expansion

		requires = { cappadocia_mission_inv_20_task }

		highlight = {
			scope:province = {
				OR = {
					is_in_region = assyria_region
					is_in_region = armenia_region
				}
			}
		}

		allow = {
			# any_owned_province = {
			# 	is_in_region = assyria_region
			# }
			OR = {
				region:assyria_region = {
					any_region_province = {
						owner = root
						count >= 5
					}
				}
				region:armenia_region = {
					any_region_province = {
						owner = root
						count >= 5
					}
				}
			}
		}

		on_completion = {
			add_manpower = 20
			custom_tooltip = armenia_assyria_claims_tt
			hidden_effect = {
				region:assyria_region = {
					every_region_province = {
						limit = {
							NOT = { owner = root }
						}
						add_claim = root
					}
				}
				region:armenia_region = {
					every_region_province = {
						limit = {
							NOT = { owner = root }
						}
						add_claim = root
					}
				}
			}
		}
	}

	cappadocia_mission_inv_21_task = { # A Tolerant Realm
		icon = task_expansion

		requires = { cappadocia_mission_inv_19A_task }

		allow = {
			invention = polycentric_administration_inv
			any_integrated_culture = {
				custom_tooltip = {
					text = cap_pers_cult_2_tt
					this.culture.culture_group = culture_group:persia
				}
			}
			any_owned_province = {
				count = all
				state_loyalty >= 90
			}
		}

		on_completion = {
			add_political_influence = 50
			add_country_modifier = {
				name = tolerant_cooperation
				duration = -1
			}
			custom_tooltip = add_claims_persia_tt
			hidden_effect = {
				region:mesopotamia_region = {
					every_region_province = {
						add_claim = root
					}
				}
				region:ariana_region = {
					every_region_province = {
						add_claim = root
					}
				}
				region:media_region = {
					every_region_province = {
						add_claim = root
					}
				}
				region:parthia_region = {
					every_region_province = {
						add_claim = root
					}
				}
				region:persis_region = {
					every_region_province = {
						add_claim = root
					}
				}
				area:harmozeia_area = {
					every_area_province = {
						add_claim = root
					}
				}
				area:adiabene_area = {
					every_area_province = {
						add_claim = root
					}
				}
			}
		}
	}

	cappadocia_mission_inv_22_task = { # Outliving the Armenians
		icon = task_expansion

		duration = 90

		requires = { cappadocia_mission_inv_19B_task }

		highlight = {
			scope:province = {
				OR = {
					is_in_area = armenia_minor_area
					is_in_area = armenia_maior_area
				}
			}
		}

		bypass = {
			NOT = {
				area:armenia_minor_area = {
					any_area_province = {
						owner = c:ARM
					}
				}
				area:armenia_maior_area = {
					any_area_province = {
						owner = c:ARM
					}
				}
			}
		}

		on_bypass = {
			if = {
				limit = {
					is_subject_of = c:ARM
				}
				set_variable = triggered_by_bypassed_var
				trigger_event = {
					id = cappadocia_event.59
				}
			}
		}

		on_start = {
			if = {
				limit = {
					is_subject_of = c:ARM
				}
				custom_tooltip = ari_cap_arm_sub_tt
				trigger_event = {
					id = cappadocia_event.59
				}
			}
			else = {
				custom_tooltip = ari_cap_arm_alliance_tt
				trigger_event = {
					id = cappadocia_event.60 # add a diplo option if you are allied
				}
			}
		}
	}

	cappadocia_mission_inv_23_task = { # A Pontic Expedition
		icon = task_expansion

		requires = { cappadocia_mission_inv_19B_task }

		duration = 365

		highlight = {
			scope:province = {
				OR = {
					is_in_area = paphlagonia_inferior_area
					is_in_area = paphlagonia_superior_area
					is_in_region = cappadocia_pontica_region
				}
			}
		}

		on_completion = {
			custom_tooltip = pontus_claims_tt
			hidden_effect = {
				region:cappadocia_pontica_region = {
					every_region_province = {
						limit = {
							NOT = { owner = root }
						}
						add_claim = root
					}
				}
				area:paphlagonia_inferior_area = {
					every_area_province = {
						limit = {
							NOT = { owner = root }
						}
						add_claim = root
					}
				}
				area:paphlagonia_superior_area = {
					every_area_province = {
						limit = {
							NOT = { owner = root }
						}
						add_claim = root
					}
				}
			}
		}
	}

	cappadocia_mission_inv_23B_task = { # A Pontic Expedition - Completion rewards (req owning)
		icon = task_expansion

		requires = { cappadocia_mission_inv_23_task }

		highlight = {
			scope:province = {
				OR = {
					province_id = 1812
					province_id = 1819
					province_id = 1790
					province_id = 1734
					province_id = 1807
				}
			}
		}

		allow = {
			owns = 1812
			owns = 1819
			owns = 1790
			owns = 1734
			owns = 1807
		}

		on_completion = {
			every_owned_province = {
				limit = {
					OR = {
						is_in_region = cappadocia_pontica_region
						is_in_area = paphlagonia_inferior_area
					}
					has_city_status = yes
					is_coastal = yes
					free_building_slots >= 1
				}
				add_building_level = port_building
			}
			add_6_free_province_investments = yes
		}
	}

	cappadocia_mission_inv_24_task = { # The New Achaemenids
		icon = task_expansion

		requires = { cappadocia_mission_inv_23B_task cappadocia_mission_inv_21_task cappadocia_mission_inv_20B_task }
		final = yes

		allow = {
			custom_tooltip = {
				text = cap_persia_tt
				tag = PER
			}
		}

		on_completion = {
			add_political_influence = 100
			add_military_experience = 80
			add_country_modifier = {
				name = new_achaemenids
				duration = -1
			}
			trigger_event = {
				id = cappadocia_event.63
			}
			custom_tooltip = persia_more_claims_tt
			hidden_effect = {
				region:syria_region = { formable_region_province_effect = yes }
				region:palestine_region = { formable_region_province_effect = yes }
				region:lower_egypt_region = { formable_region_province_effect = yes }
				region:upper_egypt_region = { formable_region_province_effect = yes }
				region:cyrenaiaa_region = { formable_region_province_effect = yes }
				region:albania_region = { formable_region_province_effect = yes }
				region:thrace_region = { formable_region_province_effect = yes }
				region:macedon_region = { formable_region_province_effect = yes }
			}
		}
	}
	# cappadocia_mission_inv_25_task = { # A Reliable Partner - this is already somewhat dealth with in "outliving the armenians"
	# 	icon = task_expansion

	# 	requires = { cappadocia_mission_inv_23_task }

	# 	allow = {}

	# 	on_completion = {}
	# }

	### Eumenes' Path
	cappadocia_mission_inv_26_task = { # Heir to the Secretary of Alexander
		icon = task_expansion

		requires = { cappadocia_mission_inv_1_task }
		prevented_by = { cappadocia_mission_inv_2A_task cappadocia_mission_inv_2B_task }

		on_completion = {
			custom_tooltip = take_over_as_eumenids_tt
			trigger_event = {
				id = cappadocia_event.64
			}
		}
	}

	cappadocia_mission_inv_27_task = { # The Ariarathid Threat
		icon = task_expansion

		requires = { cappadocia_mission_inv_26_task }

		on_completion = {
			custom_tooltip = ariarathes_returns_tt
			trigger_event = {
				id = cappadocia_event.7
			}
		}
	}

	cappadocia_mission_inv_28_task = { # Accepting the Persians
		icon = task_expansion

		requires = { cappadocia_mission_inv_26_task }

		allow = {
			any_integrated_culture = {
				is_culture = pasargadi
				has_pop_type_right = nobles
				has_country_culture_modifier = honor_guard
			}
		}

		on_completion = {
			custom_tooltip = access_persian_traditions_tt
			custom_tooltip = persian_pops_increase_tt
			hidden_effect = {
				set_variable = persian_cap_persia_mil_trads_var
				while = {
					count = 2
					every_owned_province = {
						limit = {
							has_city_status = yes
						}
						define_pop = {
							type = nobles
							culture = pasargadi
							religion = zoroaster
						}
					}
					every_owned_province = {
						limit = {
							has_city_status = no
						}
						define_pop = {
							type = citizen
							culture = pasargadi
							religion = zoroaster
						}
					}
				}
			}
			create_character = {
				culture = pasargadi
				religion = zoroaster
				female = no
				hidden_effect = {
					add_martial = 4
					add_finesse = 4
					add_trait = intelligent
				}
			}
		}
	}

	cappadocia_mission_inv_29_task = { # Revenge for Eumenes of Cardia
		icon = task_expansion

		requires = { cappadocia_mission_inv_27_task }

		allow = {
			hidden:char:37 = {
				is_alive = no
			}
			hidden:char:38 = {
				is_alive = no
			}
		}

		on_completion = {
			current_ruler = {
				add_popularity = 10
			}
			add_political_influence = 25
		}
	}

	cappadocia_mission_inv_30_task = { # Securing the Anatolian Landmass
		icon = task_expansion

		requires = { cappadocia_mission_inv_29_task }

		highlight = {
			scope:province = {
				NOT = {
					owner = root
				}
				OR = {
					is_in_region = cilicia_region
					is_in_region = cappadocia_pontica_region
					is_in_region = cappadocia_region
					is_in_region = galatia_region
					is_in_region = asia_region
				}
				# NOT = {
				# 	is_in_area = cyprus_area
				# }
			}
		}

		allow = {
			region:cilicia_region = {
				any_region_province = {
					# NOT = {
					# 	is_in_area = cyprus_area
					# }
					owner = root
					count = all
				}
			}
			region:cappadocia_pontica_region = {
				any_region_province = {
					owner = root
					count = all
				}
			}
			region:cappadocia_region = {
				any_region_province = {
					owner = root
					count = all
				}
			}
			region:galatia_region = {
				any_region_province = {
					owner = root
					count = all
				}
			}
			region:asia_region = {
				any_region_province = {
					owner = root
					count = all
				}
			}
			region:bithynia_region = {
				any_region_province = {
					owner = root
					count = all
				}
			}
		}

		on_completion = {
			change_country_name = EUMENID_EMPIRE_NAME
			change_government = imperium
			add_4_free_province_investments = yes
			add_country_modifier = {
				name = eumenid_empire
				duration = -1
			}
		}
	}

	cappadocia_mission_inv_31_task = { # Stamping Out the Antigonid Realm
		icon = task_expansion

		requires = { cappadocia_mission_inv_29_task }

		allow = {
			rank >= major_power
			c:PRY = {
				OR = {
					has_land = no
					is_subject_of = root
				}
			}
		}

		on_completion = {
			current_ruler = {
				add_popularity = 25
			}
			add_political_influence = 50
			add_military_experience = 80
			add_manpower = 20
			custom_tooltip = cilicia_pedias_claims_tt
			hidden_effect = {
				area:cilicia_pedias_area = {
					every_area_province = {
						limit = {
							NOT = { owner = root }
						}
						add_claim = root
					}
				}
			}
		}
	}

	cappadocia_mission_inv_32_task = { # Competitors in Asia
		icon = task_expansion

		requires = { cappadocia_mission_inv_30_task }

		bypass = {
			c:SEL = {
				has_land = no
			}
		}
		
		allow = {
			OR = {
				is_subject = no
				is_subject_of = c:SEL
			}
		}

		on_completion = {
			custom_tooltip = seleukid_ultimatum_tt
			if = {
				limit = {
					root = {
						is_subject_of = c:SEL
					}
				}
				trigger_event = {
					id = cappadocia_event.57
				}
			}
			else = {
				trigger_event = {
					id = cappadocia_event.58
				}
			}
		}
	}

	cappadocia_mission_inv_33_task = { # The Spoils of Cilicia Pedias
		icon = task_expansion

		requires = { cappadocia_mission_inv_31_task }

		highlight = {
			scope:province = {
				OR = {
					is_in_area = cilicia_pedias_area
				}
			}
		}

		allow = {
			manpower >= 10
			area:cilicia_pedias_area = {
				any_area_province = {
					count = all
					owner = root
				}
			}
		}

		on_completion = {
			custom_tooltip = cilicia_treasure_tt
			trigger_event = {
				id = cappadocia_event.65
			}
		}
	}

	cappadocia_mission_inv_34_task = { # Alexander’s Empire
		icon = task_expansion

		requires = { cappadocia_mission_inv_32_task }
		final = yes

		allow = {
			owns = 790 # Antigoneia
			owns = 278 # Pergamon
			owns = 379 # Pella
		}

		on_completion = {
			show_as_tooltip = {
				custom_tooltip = access_to_hellenistic_empire_tree_tt
				set_variable = allow_hellenistic_empire_tree_var
				add_country_modifier = {
					name = new_succesor_kingdom
					duration = -1
				}
				add_political_influence = 100
				add_manpower = 10
			}
			trigger_event = {
				id = cappadocia_event.66
			}
		}
	}

	cappadocia_mission_inv_35_task = { # Alexander’s Vision
		icon = task_expansion

		requires = { cappadocia_mission_inv_32_task }

		allow = {
			current_ruler = {
				popularity >= 90
			}
			political_influence >= 200
			stability >= 65
		}

		on_completion = {
			custom_tooltip = alexander_vision_claims_tt
			hidden_effect = {
				alexanders_vision_claim_effect = yes
			}
			add_country_modifier = {
				name = realizing_alexanders_vision
				duration = -1
			}
		}
	}

	cappadocia_mission_inv_34B_task = { # Greek
		icon = task_expansion

		requires = { cappadocia_mission_inv_26_task }

		highlight = {}

		allow = {
			political_influence >= 25
			any_country_culture = {
				is_culture = thracian
				country_culture_pop_count >= 25
			}
		}

		on_completion = {
			add_political_influence = -25
			set_primary_culture_cleanup_effect = {
				NEW_PRIMARY_CULTURE = thracian
				MAKE_OLD_CULTURE_INTEGRATED = yes
			}
			capital_scope = {
				define_pop = {
					type = nobles
					religion = roman_pantheon
					culture = thracian
				}
				define_pop = {
					type = citizen
					religion = roman_pantheon
					culture = thracian
				}
				define_pop = {
					type = citizen
					religion = roman_pantheon
					culture = thracian
				}
				define_pop = {
					type = freemen
					religion = roman_pantheon
					culture = thracian
				}
				define_pop = {
					type = freemen
					religion = roman_pantheon
					culture = thracian
				}
			}
			custom_tooltip = thracian_cap_opinion_tt
			hidden_effect = {
				every_country = {
					limit = {
						country_culture_group = hellenic
						NOT = {
							primary_culture = macedonian
						}
					}
					add_opinion = {
						modifier = cap_greek_pos_opmod
						target = root
					}
				}
				every_country = {
					limit = {
						primary_culture = macedonian
					}
					add_opinion = {
						modifier = cap_greek_neg_opmod
						target = root
					}
				}
			}
		}
	}

	cappadocia_mission_inv_34C_task = { # Protectors of the Argeads
		icon = task_expansion

		requires = { cappadocia_mission_inv_34B_task }

		allow = {
			hidden:char:42 = { # Ptolemy
				is_alive = no
			}
			hidden:char:37 = { # Antigonos
				is_alive = no
			}
			hidden:char:24 = { # Seleukos
				is_alive = no
			}
			hidden:char:32 = { # Kassander
				is_alive = no
			}
			hidden:char:41 = { # Lysimachos
				is_alive = no
			}
			OR = {
				AND = {
					current_ruler = {
						is_married = no
					}
					custom_tooltip = {
						text = argead_in_court_tt
						any_character = {
							trigger_if = {
								root.current_ruler = {
									is_female = no
								}
								is_female = yes
							}
							trigger_else_if = {
								root.current_ruler = {
									is_female = yes
								}
								is_female = no
							}
							has_trait = argeads
							is_married = no
						}
					}
				}
				current_ruler = {
					is_married = yes
					trigger_if = {
						limit = {
							is_married = yes
						}
						spouse = {
							has_trait = argeads
						}
					}
				}
			}
		}

		on_completion = {
			if = {
				limit = {
					current_ruler = {
						is_married = no
					}
				}
				random_character = {
					limit = {
						trigger_if = {
							root.current_ruler = {
								is_female = no
							}
							is_female = yes
						}
						trigger_else_if = {
							root.current_ruler = {
								is_female = yes
							}
							is_female = no
						}
						has_trait = argeads
						is_married = no
					}
					marry_character = root.current_ruler
				}
				add_political_influence = 25
			}
			else = {
				add_political_influence = 50
			}
		}
	}

	cappadocia_mission_inv_34D_task = { # Royalist
		icon = task_expansion

		requires = { cappadocia_mission_inv_34C_task }

		allow = {
			current_ruler = {
				has_trait = argeads
			}
		}


		on_completion = {
			add_country_modifier = {
				name = last_royalist
				duration = -1
			}
		}
	}

    ### Branch 4 - Developing Cappadocia
	cappadocia_mission_inv_1d_task = { #The Trading Hub of Mazaka
		icon = task_economical

		highlight = {
			scope:province = {
				province_id = 1799
			}
		}

		allow = {
			p:1799 = { #Mazaka
				owner = root
				is_capital = yes
				num_of_commerce_building >= 6
				num_of_forum_building >= 3
				num_of_nobles >= 10
				province_income > 0.2
			}
		}

		on_completion = { 
			add_4_free_province_investments = yes
		}
	}
	cappadocia_mission_inv_2d_task = {  #Cappadocian Cavalry

		icon = task_economical

		requires = { cappadocia_mission_inv_1d_task }

		allow = {}

		on_completion = {}
	}   
	cappadocia_mission_inv_3d_task = { #The Palace of Gazioura p:7998
		icon = task_expansion

		requires = { cappadocia_mission_inv_1d_task }

		allow = {}

		on_completion = {}
	}
	cappadocia_mission_inv_4d_task = { #Hellenization of Cappadocia

		icon = task_expansion

		requires = { cappadocia_mission_inv_2d_task }

		allow = {}

		on_completion = {}
	}
	cappadocia_mission_inv_5d_task = { #Expand the Underground Cities
		icon = task_expansion

		requires = { cappadocia_mission_inv_2d_task cappadocia_mission_inv_3d_task }

		allow = {}

		on_completion = {}
	}
	cappadocia_mission_inv_6d_task = { #Administration in Tyana
		icon = task_expansion

		requires = { cappadocia_mission_inv_3d_task }

		allow = {}

		on_completion = {}
	}
	cappadocia_mission_inv_7d_task = { #Cappadocian Training

		icon = task_expansion

		requires = { cappadocia_mission_inv_4d_task }

		allow = {}

		on_completion = {}
	}
	cappadocia_mission_inv_8d_task = { # A Cappadocian Coast
		icon = task_expansion

		requires = { cappadocia_mission_inv_6d_task }

		allow = {}

		on_completion = {}
	}
	cappadocia_mission_inv_9d_task = { # Cilician Enterprise
		icon = task_expansion

		requires = { cappadocia_mission_inv_6d_task }

		allow = {}

		on_completion = {}
	}
}