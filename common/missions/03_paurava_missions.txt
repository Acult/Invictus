paurava_missions = {
	header = "indian_mission_header"
	icon = "seleukid_3" #Placeholder
	repeatable = no
	chance = { factor = 50000 }

	potential = {
		NOT = { has_variable = paurava_missions_cooldown }
		TAG = PRA
	}
	on_start = {
		save_scope_as = mission_country
	}
	abort = {
		ai_mission_back_out_trigger = yes
	}
	on_abort = {
		custom_tooltip = general_mission_cooldown_tt
        set_variable = {
            name = paurava_missions_cooldown
            days = 7300
	 	}
	}
	on_completion = {
		complete_mission_effect = yes
	}

	paurava_missions_task_0 = { # Children of Porus
		icon = "task_conquest"
		allow = {
			tag = PRA
		}
		duration = 25
		on_completion = {
			trigger_event = {
				id = me_paurava.20
			}
			add_country_modifier = {
				name = approval_of_the_people
				duration = 1000
			}
		}
	}

 # Sialkot Development Branch #
	paurava_missions_task_1 = { # Capital of the Madras
		icon = "task_economical"
		requires = {
			paurava_missions_task_0
		}
		allow = {
			p:4340 = {
				has_city_status = yes
				has_building = aqueduct_building
				has_building = commerce_building
				has_construction = no	
				num_of_used_building_slots >= 3
			}
		}
		on_completion = {
			add_2_free_province_investments = yes
			p:4340 = {
				add_permanent_province_modifier = {
					name = trade_hub_sakala
				}
			}
			trigger_event = {
				id = me_paurava.40
			}
		}
	}
	paurava_missions_task_2 = { # Sakalan Silk
		icon = "task_economical"
		requires = { paurava_missions_task_1 }
		highlight = {
			scope:province = {	
				owner = root
				OR = {
					trade_goods = silk
					trade_goods = leather
					trade_goods = cloth
				}
			}
		}
		allow = {
			capital_scope = {
				calc_true_if = {
					amount >= 2
					is_importing_trade_good = leather
					is_importing_trade_good = cloth
					state = {
						trade_good_imports = {
							target = silk
							value >= 2
						}
					}
				}
			}
		}
		on_completion = {
			p:4340 = {
				set_trade_goods = silk
			}
			trigger_event = {
				id = me_paurava.1 #Province trade good change
			}
		}
	}
	paurava_missions_task_3 = { # Sack of Taxila
		icon = "task_conquest"
		requires = {
			paurava_missions_task_2
		}
		prevented_by = {
			paurava_missions_task_5
		}
		bypass = {
			has_completed_mission_task = paurava_missions_task_5
		}
		highlight = {
            scope:province = {
            	is_in_area = taxila_area
            }
        }
		allow = {
			owns = 7314
			p:7314 = {
				total_population <= 45
				governor_policy = harsh_treatment
			}
		}
		on_completion = {
			random_owned_province = {
				limit = {
					is_in_area = gandhara_area
				}
				add_state_loyalty = subtract_state_province_loyalty_huge
			}
			current_ruler = {
				add_popularity = -20
			}
			p:7314 = {
				while = {
					count = 5
					random_pops_in_province = {
						kill_pop = yes
					}
				}	
			}
			add_province_modifier = {
				name = destroyer_of_taxila
				duration = 1800
			}
			destroy_building_effect = yes
			trigger_event = {
				id = me_paurava.41
			}
		}
	}
	paurava_missions_task_4 = { # Academy of Sakala - Turn this mission into an eventchain instead of using a duration, on_start and on_completion
		icon = "task_economical"
		requires = {
			paurava_missions_task_3
		}
		bypass = {
			has_completed_mission_task = paurava_missions_task_5
		}
		duration = 720
		allow = {
			capital_scope = {
				great_work_locator_is_free = yes
			}
			p:7314 = {
				owner = root
				has_great_work = no
			}
			treasury >= 1000
		}
		on_start = {
			capital_scope = {
				begin_great_work_construction = {
					great_work = "sakala_academy"
					locator = great_work
					is_ancient = yes
				}
			}
			add_treasury = -1000
		}
		
		on_completion = {
			capital_scope = {
				finish_great_work_construction = {
					great_work = "sakala_academy"
					locator = great_work
				}
			}
			trigger_event = {
				id = me_paurava.42
			}
		}
	}
	paurava_missions_task_5 = { # A Second Capital
		icon = "task_diplomatic"
		requires = {
			paurava_missions_task_2
		}
		prevented_by = {
			paurava_missions_task_3
		}
		bypass = {
			has_completed_mission_task = paurava_missions_task_3
		}
		highlight = {
			scope:province = {
				this = p:7314
			}
		}
		allow = {
			p:7314 = {
				num_of_academy_building >= 2
				num_of_library_building >= 2
			}
			p:7314 = {
				total_population > 30
			}
		}
		on_completion = {
			current_ruler = {
				add_finesse = 2
			}
			add_country_modifier = {
				name = second_capital
				duration = -1
			}
			p:7314 = {
                while = {
                    count = 6
                    random_pops_in_province = {
                        limit = {
                            NOT = { pop_culture = root.culture }
                        }
                        set_pop_culture = root.culture
                    }
                }
            }
			trigger_event = {
				id = me_paurava.43
			}
        }
	}
	paurava_missions_task_6 = { # Center of Faith
		icon = "task_religion"
		requires = {
			paurava_missions_task_4
			paurava_missions_task_5
		}
		allow = {
			current_ruler = {
				popularity >= 90
			}
			legitimacy >= 90
			stability >= 45
			p:4340 = {
				total_population >= 40
			}
		}
		on_completion = {
			trigger_event = {
				id = me_paurava.2 # Spread 1/4 Religions
			}
			current_ruler = {
				add_zeal = 3
			}
		}
	}
	paurava_missions_task_22 = { # Spread Vedic
		icon = "task_religion"
		requires = {
			paurava_missions_task_6
		}
		prevented_by = {
			paurava_missions_task_23
			paurava_missions_task_24
			paurava_missions_task_25
		}
		bypass = {
			OR = {
				has_completed_mission_task = paurava_missions_task_23
				has_completed_mission_task = paurava_missions_task_24
				has_completed_mission_task = paurava_missions_task_25
			}
		}
		allow = {
			custom_tooltip = {
				has_variable = center_of_vedic
				text = "Has spread the corresponding faith previously."
			}
			treasury >= 125
			political_influence >= 100
		}
		on_start = {
			add_treasury = -125
			add_political_influence = -50
		}
		duration = 30
		on_completion = {
			add_country_modifier = {
				name = center_of_faith
				duration = 7000
			}
			trigger_event = {
				id = me_paurava.10
			}
		}
	}
	paurava_missions_task_23 = { # Spread Buddhism
		icon = "task_religion"
		requires = {
			paurava_missions_task_6
		}
		prevented_by = {
			paurava_missions_task_22
			paurava_missions_task_24
			paurava_missions_task_25
		}
		bypass = {
			OR = {
				has_completed_mission_task = paurava_missions_task_22
				has_completed_mission_task = paurava_missions_task_24
				has_completed_mission_task = paurava_missions_task_25
			}
		}
		allow = {
			custom_tooltip = {
				has_variable = center_of_buddhism
				text = "Has spread the corresponding faith previously."
			}
			treasury >= 125
			political_influence >= 100
		}
		on_start = {
			add_treasury = -125
			add_political_influence = -50
		}
		duration = 30
		on_completion = {
			add_country_modifier = {
				name = center_of_faith
				duration = 3600
			}
			trigger_event = {
				id = me_paurava.10
			}
		}
	}
	paurava_missions_task_24 = { # Spread Jain
		icon = "task_religion"
		requires = {
			paurava_missions_task_6
		}
		prevented_by = {
			paurava_missions_task_23
			paurava_missions_task_22
			paurava_missions_task_25
		}
		bypass = {
			OR = {
				has_completed_mission_task = paurava_missions_task_23
				has_completed_mission_task = paurava_missions_task_22
				has_completed_mission_task = paurava_missions_task_25
			}
		}
		allow = {
			custom_tooltip = {
				has_variable = center_of_jain
				text = "Has spread the corresponding faith previously."
			}
			treasury >= 125
			political_influence >= 100
		}
		on_start = {
			add_treasury = -125
			add_political_influence = -50
		}
		duration = 30
		on_completion = {
			add_country_modifier = {
				name = center_of_faith
				duration = 3600
			}
			trigger_event = {
				id = me_paurava.10
			}
		}
	}
	paurava_missions_task_25 = { # Spread Ajivika
		icon = "task_religion"
		requires = {
			paurava_missions_task_6
		}
		prevented_by = {
			paurava_missions_task_23
			paurava_missions_task_22
			paurava_missions_task_24
		}
		bypass = {
			OR = {
				has_completed_mission_task = paurava_missions_task_23
				has_completed_mission_task = paurava_missions_task_22
				has_completed_mission_task = paurava_missions_task_24
			}
		}
		allow = {
			custom_tooltip = {
				has_variable = center_of_ajivika
				text = "Has spread the corresponding faith previously."
			}
			treasury >= 125
			political_influence >= 50
		}
		on_start = {
			add_treasury = -125
			add_political_influence = -100
		}
		duration = 30
		on_completion = {
			add_country_modifier = {
				name = center_of_faith
				duration = 3600
			}
			trigger_event = {
				id = me_paurava.10
			}
		}
	}
	paurava_missions_task_26 = { # Religious Capital of the Indus
		requires = {
			paurava_missions_task_22
			paurava_missions_task_23
			paurava_missions_task_24
			paurava_missions_task_25
		}
		allow = {
			#Write tooltip still for the 40%
			custom_tooltip = {
				text = "40% or more of the people follow the state religion"
				paurava_missions_task_26_current >= paurava_missions_task_26_needed
			}
		}
		on_completion = {
			trigger_event ={
				id = me_paurava.46
			}
		}
	}
	paurava_missions_task_7 = { # Mauryan Marriage
		icon = "task_diplomatic"
		requires = {
			paurava_missions_task_0
		}
		allow = {
			any_country = {
				tag = MRY
				opinion = {
					target = root 
					value >= 100				
				}
			}
			c:MRY.current_ruler = {
				is_friend = root.current_ruler
			}
		}
		on_completion = {
			c:MRY = {
				random_character = {
					limit = {
						NOT = { this = c:MRY.current_ruler.spouse }
						has_trait = maurya
						is_female = yes
						age <= 28
						age > 15
					}
					if = {
						limit = { is_married = yes }
						divorce_character = spouse
					}
					save_scope_as = marriage_partner
				}
			}
			current_ruler = {
				marry_character = scope:marriage_partner
			}
			trigger_event = {
				id = me_paurava.24
			}
		}
	}
	paurava_missions_task_8 = { # Land of Five Rivers
		icon = "task_diplomatic"
		requires = {
			paurava_missions_task_7
		}
		allow = {
			any_country = {
				tag = MRY
				opinion = {
					target = root
					value >= 120			
				}
			}
			political_influence >= 30
			treasury >= 100
		}
		on_completion = {
			add_political_influence = -30
			add_treasury = -100
			trigger_event = {
				id = me_paurava.3 # Annex Panchanada
			}
		}
	}
	paurava_missions_task_9 = { # Matter of the Madrakas
		icon = "task_conquest"
		requires = { paurava_missions_task_7 }
		allow = {
			political_influence >= 15
		}
		on_start = {
			trigger_event = {
				id = me_paurava.4 # Claims on Madra
			}
		}
		duration = 90
		on_completion = {
			declare_war_with_wargoal = {
				war_goal = conquer_wargoal
				province = 4347
				target = c:KLS
			}
			if = {
				limit = { alliance_with = c:MRY }
				break_alliance = c:MRY
				add_truce = {
					target = c:MRY
					duration = 1825 # 5 years
				}
			}
			trigger_event = {
				id = me_paurava.23
			}
		}
	}
	paurava_missions_task_10 = { # Kings of Gandhara
		icon = "task_political"
		requires = { paurava_missions_task_7 }
		on_start = {
			trigger_event = {
				id = me_paurava.21
			}
			political_influence >= 30
		}
		duration = 30
		on_completion = {
			trigger_event = {
				id = me_paurava.22
			}
		}
	}
	paurava_missions_task_11 = { # King Porus' Kingdom
		icon = "task_happiness"
		requires = {
			paurava_missions_task_8
			paurava_missions_task_9
			paurava_missions_task_10
		}
		allow = {
			owns_region = gandhara_region
		}
		on_completion = {
			add_country_modifier = {
				name = blessing_of_porus # maybe add him as a deity ?
				duration = -1
			}
			trigger_event = {
				id = me_paurava.44
			}
		}
	}
	paurava_missions_task_12 = { # Menace from Macedon
		icon = "task_battle"
		requires = {
			paurava_missions_task_11
		}
		allow = {
			OR = {
				exists = c:SEL
				exists = c:BAC
				exists = c:ARS
			}
		}
		on_completion = {
			area:sattagydia_area = {
				every_area_province = {
					add_claim = root
				}
			}
			area:arachosia_area = {
				every_area_province = {
					add_claim = root
				}
			}
			area:bamyan_area = {
				every_area_province = {
					add_claim = root
				}
			}
			trigger_event = {
				id = me_paurava_45
			}
		}
	}

	paurava_missions_task_15 = { # Greek Presence in India
		icon = "task_happiness"
		allow = {
	        any_owned_province = {
				custom_tooltip = {
					any_pops_in_province = {
                		pop_culture_group = hellenic
              		}
					text = "Any pops in province are Hellenic culture."
				}
            	
            }
			custom_tooltip = {
				text = "This mission cannot be completed until the Indo-Greek Kingdoms have arrived."
				has_global_variable = maurya_collapse_happened
			}
		}
		on_completion = {
			add_country_modifier = {
				name = indo_greek_unrest
				duration = -1
			}
			trigger_event = {
				id = me_paurava.5 # Explanatory Event
			}
		}
	}
	paurava_missions_task_16 = { # Home for the Hellenes
		icon = "task_diplomatic"
		requires = {
			paurava_missions_task_15
		}
		prevented_by = {
			paurava_missions_task_17
			paurava_missions_task_18
		}
		highlight = {
			scope:province = {
				OR = {
					province_id = 6821
					province_id = 4371
					province_id = 7314
					province_id = 4353
				}
			}
		}
		allow = {
			owns = 6821
			owns = 4371
			owns = 7314
			owns = 4353

			any_owned_province = {
				count = 20
				any_pops_in_province = {
					pop_culture_group = hellenic
				}
			}
			stability >= 40
			political_influence >= 80
			treasury >= 400
			any_country_culture = {
				this.culture_group = culture_group:hellenic
				is_integrated = yes
			}
        }
		on_completion = {
			add_country_modifier = {
				name = indo_hellenic_home
			}
			add_political_influence = -80
			add_treasury = -400
			add_stability = -10
			trigger_event = {
				id = me_paurava.47
			}
			set_variable = greek_crisis_solved
		}
	}
	paurava_missions_task_17 = { # Get Out Greeks !
		icon = "task_conquest"
		requires = {
			paurava_missions_task_15
		}
		prevented_by = {
			paurava_missions_task_16
			paurava_missions_task_18
		}
		highlight = {
			scope:province = {
				OR = {
					province_id = 6821
					province_id = 4371
					province_id = 7314
					province_id = 4353
				}
			}
		}
		allow = {
			owns = 6821
			owns = 4371
			owns = 7314
			owns = 4353
			any_country_culture = {
				this.culture_group = culture_group:hellenic
				has_pop_type_right = slaves
			}
			stability >= 40
			political_influence >= 25
		}
		trigger_event = {
			id = me_paurava.49
		}
		set_variable = greek_crisis_solved
	}
	paurava_missions_task_18 = { # Embrace Hellenic Thought / Pentapotamia
		icon = "task_political"
		requires = {
			paurava_missions_task_15
		}
		prevented_by = {
			paurava_missions_task_16
			paurava_missions_task_17
		}
		highlight = {
			scope:province = {
				OR = {
					province_id = 6821
					province_id = 4371
					province_id = 7314
					province_id = 4353
				}
			}
		}
		allow = {
			owns = 6821
			owns = 4371
			owns = 7314
			owns = 4353
			p:4371 = {
				has_city_status = yes
				total_population >= 45
			}
			current_ruler = {
				popularity >= 90
			}
			legitimacy >= 90
			stability >= 60
		}
		on_completion = {
			while = {
				count = 15
				region:gandhara_region = {
		        	random_region_province = {
		        		limit = {
		        			owner = root
		        			any_pops_in_province = {
		        				pop_culture = purus
		        				NOT = { pop_type = tribesmen }
		        				NOT = { pop_type = slaves }		        				
		        			}
		        		}
		        		random_pops_in_province = {
		        			limit = {
		        				pop_culture = purus
		        				NOT = { pop_type = tribesmen }
		        				NOT = { pop_type = slaves }
		        			} 
		        			set_pop_culture = greco_indian
		        		}
		        	}
		        }			
			}
			add_stability = -15
			add_legitimacy = -40
			change_country_name = "PENTAPOTAMIA"
			hidden_effect = {
				change_country_flag = PENTAPOTAMIAN_FLAG
				change_country_color = "punjabi_orange"
				if = {
					limit = {
						NOT = {
							primary_culture = greco_indian
						}
					}
					set_primary_culture_cleanup_effect = {
						NEW_PRIMARY_CULTURE = greco_indian
						MAKE_OLD_CULTURE_INTEGRATED = yes
					}
				}	
			}
			every_character = {
                limit = {
                    OR = {
                        from_ruler_family = yes
                        is_minor_character = no
                    }
                }
                set_culture = greco_indian
			}
			trigger_event = {
				id = me_paurava_50
			}
			set_variable = greek_crisis_solved
		}
	}
	paurava_missions_task_27 = { # The Greek Gods
		icon = "task_religion"
		requires = {
			paurava_missions_task_18
		}
		allow = {
			political_influence >= 25
			stability >= 50
		}
		on_completion = {
			trigger_event = {
				id = me_paurava.48
			}
		}
	}
	paurava_missions_task_19 = { # Greek Matter Solved
		icon = "task_happiness"
		requires = {
			paurava_missions_task_18
			paurava_missions_task_17
			paurava_missions_task_16
		}
		on_completion = {
			add_country_modifier = {
				name = hellenic_advancement
				duration = 1000
			}
			has_variable = greek_crisis_solved
			remove_country_modifier = indo_greek_unrest
		}
	}
	paurava_missions_task_20 = { # Hellenic Horizon
		icon = "task_conquest"
		requires = {
			paurava_missions_task_19
		}
		on_completion = {
			trigger_event = {
				id = me_paurava.6
			}
		}
	}
	paurava_missions_task_21 = { # Subdue the South
		icon = "task_conquest"
		requires = {
			paurava_missions_task_19
		}
		on_completion = {
			trigger_event = {
				id = me_paurava.7
			}
		}
	}
	paurava_missions_task_30 = { # The River Ganges
		icon = "task_conquest"
		requires = {
			paurava_missions_task_19
		}
		on_completion = {
			
		}
	}
	paurava_missions_task_31 = { # Proceed to Pracya
		icon = "task_conquest"
		requires = {
			paurava_missions_task_30
		}
		on_completion = {
			
		}
	}
	paurava_missions_task_32 = { # Conquest of India
		icon = "task_conquest"
		requires = {
			paurava_missions_task_31
			paurava_missions_task_21
		}
		on_completion = {
			
		}
	}
	paurava_missions_task_33 = { # Final Task
		icon = "task_happiness"
		requires = {
			paurava_missions_task_32
			paurava_missions_task_26
		}
		on_completion = {
			add_manpower = 25
			trigger_event = {
				id = me_paurava.100
			}
		}
		final = yes
	}
}